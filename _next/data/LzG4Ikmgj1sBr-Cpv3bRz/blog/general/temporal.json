{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var d=Object.create;var t=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var o=a=>t(a,\"__esModule\",{value:!0});var N=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=>{o(a);for(var c in s)t(a,c,{get:s[c],enumerable:!0})},g=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let e of h(s))!u.call(a,e)&&e!==\"default\"&&t(a,e,{get:()=>s[e],enumerable:!(c=p(s,e))||c.enumerable});return a},f=a=>g(o(t(a!=null?d(m(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=N((x,i)=>{i.exports=_jsx_runtime});var T={};k(T,{default:()=>b,frontmatter:()=>w});var n=f(r()),w={title:\"An InfoSec Architect's First Taste of Temporal\",date:\"2025-07-08\",tags:[\"Secrets Management\"],draft:!1,summary:\"This is a therapy session for anyone traumatized by fragile scripts. I traded my `cron/try/catch` nightmares for a robot project manager named Temporal.\",images:[]};function y(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({p:\"p\",code:\"code\",strong:\"strong\",a:\"a\",h2:\"h2\",span:\"span\",h3:\"h3\",ul:\"ul\",li:\"li\",pre:\"pre\"},a.components),{Image:l}=e;return l||v(\"Image\",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"It's the spring of 2005. I'm staring at a computer monitor the size of a small refrigerator, the kind that makes a thunk sound when you turn it on. My mission? Installing Red Hat 9(Not RHEL!) and learning this magical command called \",(0,n.jsx)(e.code,{children:\"cron\"}),\". It felt like peak technology\\u2014telling the computer to do something later, automatically!\"]}),(0,n.jsxs)(e.p,{children:[\"Fast forward a decade or two, and I'm a professional developer. \",(0,n.jsx)(e.code,{children:\"cron\"}),\" is still around, but now I'm also writing code to handle the chaos between microservices. This is where I met my white whale, one of the most terrifying bugs of my career. I was working on a backend service for an app with over a billion daily active users (no pressure, right?). In a moment of what I thought was pure genius, I added some retry logic inside a \",(0,n.jsx)(e.code,{children:\"try...catch\"}),\" block. The problem? Another bug in my retry code caused it to... throw another \",(0,n.jsx)(e.code,{children:\"exception\"}),\".\"]}),(0,n.jsxs)(e.p,{children:[\"The result was an infinite loop of failures, like trying to put out a fire with a gasoline-filled water gun. It was a horrifying lesson: \",(0,n.jsx)(e.strong,{children:\"manually writing robust retry and recovery logic is a dangerous, soul-crushing business\"}),\".\"]}),(0,n.jsxs)(e.p,{children:[\"Recently, I was brainstorming how to build a \",(0,n.jsx)(e.a,{href:\"https://www.supasaf.com/blog/raft-algo\",children:\"cost-effective secrets management system\"}),\". I stumbled upon \",(0,n.jsx)(e.a,{href:\"https://www.uber.com/en-HK/blog/building-ubers-multi-cloud-secrets-management-platform/\",children:\"a blog post from Uber\"}),\" about their system, and a tool called Cadence was the star of the show. This led me to its successor, Temporal, and I decided to build a small demo to see if it could finally save me from my retry-logic nightmares.\"]}),(0,n.jsx)(e.p,{children:\"And oh boy, it can.\"}),(0,n.jsxs)(e.h2,{id:\"so-what-is-temporal\",children:[(0,n.jsx)(e.a,{href:\"#so-what-is-temporal\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"So, What is Temporal?\"]}),(0,n.jsx)(e.p,{children:\"Imagine Temporal is a super-smart, patient, and forget-proof project manager. This manager doesn't do the actual work (your code does that), but it orchestrates, supervises, and remembers every single detail of a complex project, ensuring it gets done perfectly, no matter what disasters happen along the way.\"}),(0,n.jsxs)(e.p,{children:['For our scenario, the \"complex project\" is this: ',(0,n.jsx)(e.strong,{children:\"Safely rotate a database password for a critical service deployed across multiple regions\"}),\".\"]}),(0,n.jsx)(e.p,{children:\"Let's see how our new project manager, Temporal, handles this job.\"}),(0,n.jsxs)(e.h2,{id:\"example--the-cross-region-key-rotation-workflow\",children:[(0,n.jsx)(e.a,{href:\"#example--the-cross-region-key-rotation-workflow\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),'Example : The \"Cross-Region Key Rotation\" Workflow']}),(0,n.jsx)(e.p,{children:'Our goal: Rotate the database password for \"Payment Service A,\" which runs in both Azure East US and Azure West US. The whole process might take 10 minutes, and failure is not an option.'}),(0,n.jsxs)(e.h3,{id:\"step-1-kicking-off-the-project-scheduling\",children:[(0,n.jsx)(e.a,{href:\"#step-1-kicking-off-the-project-scheduling\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 1: Kicking Off the Project (Scheduling)\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"The Old Way\"}),\": You\\u2019d set up an external cron job to trigger a script every 90 days. Hope the server running cron doesn't go down!\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"The Temporal Way\"}),': You define a Workflow and simply tell it, \"Run yourself every 90 days.\" Temporal has powerful, built-in scheduling. It will reliably kick off the project right on time.']}),(0,n.jsxs)(e.h3,{id:\"step-2-generating-the-new-password-executing-a-task\",children:[(0,n.jsx)(e.a,{href:\"#step-2-generating-the-new-password-executing-a-task\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 2: Generating the New Password (Executing a Task)\"]}),(0,n.jsxs)(e.p,{children:['The project manager (Temporal) gives the first command: \"Go generate a new password.\" (This calls a ',(0,n.jsx)(e.code,{children:\"Secret Provider API\"}),\").\"]}),(0,n.jsx)(e.p,{children:\"This task might fail because the network decided to take a coffee break.\"}),(0,n.jsx)(e.p,{children:`Temporal's Superpower (Automatic Retries): You can configure the task and tell Temporal: \"If this fails, wait 5 seconds and try again. Do this up to 3 times.\" Temporal will diligently follow your orders. You don't have to write a single try-catch-retry loop.`}),(0,n.jsxs)(e.h3,{id:\"step-3-distributing-the-new-password-state-persistence\",children:[(0,n.jsx)(e.a,{href:\"#step-3-distributing-the-new-password-state-persistence\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 3: Distributing the New Password (State Persistence)\"]}),(0,n.jsx)(e.p,{children:\"This is the critical part. Our manager now has the new password and needs to give it to two different teams:\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"Write the new password to the East US Key Vault.\"}),(0,n.jsx)(e.li,{children:\"Write the same new password to the West US Key Vault.\"})]}),(0,n.jsx)(e.p,{children:\"Disaster Strikes! Imagine the server running your code crashes right after it successfully writes to the East US vault!\"}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"The Old Way\"}),': When your program restarts, it has amnesia. It has no idea what it was doing. It might generate a new password (yikes!) or just sit there, confused, leaving your systems in an inconsistent state. You\\u2019d need to build a complex state-tracking table in a database just to remember \"Step 3a is done, but 3b is not.\"']}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Temporal's Superpower (State Persistence / Flawless Memory)\"}),`: After every successful step, Temporal automatically saves a snapshot of the workflow's progress. When the server comes back online, a new worker picks up the job and Temporal says, \"Ah, I remember! The new password was generated and already sent to East US. My next task is to send it to West US.\" This guarantees the workflow runs exactly once without missing a beat or redoing work.`]}),(0,n.jsxs)(e.h3,{id:\"step-4-waiting-for-confirmation-long-running--timeouts\",children:[(0,n.jsx)(e.a,{href:\"#step-4-waiting-for-confirmation-long-running--timeouts\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 4: Waiting for Confirmation (Long-Running & Timeouts)\"]}),(0,n.jsx)(e.p,{children:'After distributing the password, the project manager needs to tell the deployment platform to restart the apps and then wait for them to report \"new password test successful.\"'}),(0,n.jsx)(e.p,{children:\"This waiting period could be 5-10 minutes.\"}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"The Old Way\"}),': A typical web service or script would time out or die trying to \"pause\" for that long waiting for a callback.']}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Temporal's Superpower (Long-Running Workflows)\"}),\": Temporal workflows are designed to run for a long time. A workflow can happily pause for minutes, hours, or even days waiting for an external signal, all without consuming any compute resources.\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Temporal's Superpower (Timeouts)\"}),`: You can also tell Temporal, \"If you don't hear back in 15 minutes, consider the mission a failure.\" This prevents the process from getting stuck forever.`]}),(0,n.jsxs)(e.h3,{id:\"step-5-handling-failure-recovery--compensation\",children:[(0,n.jsx)(e.a,{href:\"#step-5-handling-failure-recovery--compensation\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 5: Handling Failure (Recovery & Compensation)\"]}),(0,n.jsx)(e.p,{children:'Disaster Strikes Again! The app reports back: \"New password test FAILED!\"'}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"The Old Way\"}),`: You'd need to write a tangled mess of if-else and catch blocks to manually roll back the changes. This \"compensation\" logic (like calling an API to delete the new password version from the Key Vaults) is incredibly error-prone.`]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Temporal's Superpower (Failure Recovery)\"}),': You can define a \"cleanup plan\" or a Saga pattern right in your workflow. When Temporal receives the failure signal, it automatically executes your pre-defined rollback steps, like deleting the new secrets from both Key Vaults, restoring everything to its initial state, and sending an alert to the on-call engineer.']}),(0,n.jsxs)(e.h2,{id:\"lets-build-it-a-hands-on-temporal-project\",children:[(0,n.jsx)(e.a,{href:\"#lets-build-it-a-hands-on-temporal-project\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Let's Build It! A Hands-On Temporal Project\"]}),(0,n.jsxs)(e.h3,{id:\"step-zero-prep-your-dev-environment\",children:[(0,n.jsx)(e.a,{href:\"#step-zero-prep-your-dev-environment\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step Zero: Prep Your Dev Environment\"]}),(0,n.jsx)(e.p,{children:\"Please follow the official docs for Temporal and Vault to get them set up. I'm running my local environment in WSL on Windows.(Ask AI for the setup steps, please:p)\"}),(0,n.jsx)(e.p,{children:\"Once ready, start the Temporal and Vault services.\"}),(0,n.jsxs)(e.h3,{id:\"step-one-create-the-go-project-and-install-dependencies\",children:[(0,n.jsx)(e.a,{href:\"#step-one-create-the-go-project-and-install-dependencies\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step One: Create the Go Project and Install Dependencies\"]}),(0,n.jsx)(e.p,{children:\"Now, let's set up our project structure:\"}),(0,n.jsx)(e.pre,{className:\"language-shell\",children:(0,n.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`ss@ss:~$ tree temporal-vault-demo/\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`temporal-vault-demo/\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 go.mod\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 go.sum\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 starter\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502\\xA0 \\xA0\\u2514\\u2500\\u2500 main.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 worker\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502\\xA0 \\xA0\\u2514\\u2500\\u2500 main.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2514\\u2500\\u2500 workflow.go\n`})]})}),(0,n.jsxs)(e.h2,{id:\"step-two-write-the-workflow-and-activities-the-core-logic\",children:[(0,n.jsx)(e.a,{href:\"#step-two-write-the-workflow-and-activities-the-core-logic\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step Two: Write the Workflow and Activities (The Core Logic)\"]}),(0,n.jsxs)(e.p,{children:[\"In your temporal-vault-demo directory, create a new file named \",(0,n.jsx)(e.code,{children:\"workflow.go\"}),\". This is where we'll define the master plan for our project manager.\"]}),(0,n.jsxs)(e.p,{children:[\"In Temporal, any action that has a side effect (like an API call, database write, or reading from a file) should be in an \",(0,n.jsx)(e.strong,{children:\"Activity\"}),\". The \",(0,n.jsx)(e.strong,{children:\"Workflow\"}),\" is the orchestrator that calls these Activities in the correct order.\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"workflow.go\"}),\" Code:\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-go\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"package\"}),` temporal_vault_demo\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"context\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"crypto/rand\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"fmt\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"math/big\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"time\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"github.com/hashicorp/vault/api\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"go.temporal.io/sdk/activity\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"go.temporal.io/sdk/workflow\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// ========================================================================\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:'// 1. Activities - The actual \"doers\" of work'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// ========================================================================\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" Activities \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tVaultClient \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"api\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`Client\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// GeneratePassword is an activity that creates a random password.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// We should use KMS service in real world\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"a \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"Activities\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"GeneratePassword\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"error\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tactivity\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"GetLogger\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Info\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Generating a new password...\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tchars \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlength \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tpassword \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\" length\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" i\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"++\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" rand\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"rand\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Reader\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" big\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewInt\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"int64\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"chars\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` err\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tpassword \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"chars\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"n\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Int64\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" password\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// WriteSecretToVault is an activity that writes a secret to a given path in Vault.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// We should use the APIs from Cloud Service Provider to write it to, like Azure Key Vault\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"a \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"Activities\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"WriteSecretToVault\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" path \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" secretValue \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"error\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlogger \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" activity\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"GetLogger\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlogger\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Info\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Writing secret to Vault path.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Path\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" path\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tsecretData \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"map\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"password\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" secretValue\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"_\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"VaultClient\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"KVv2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"secret\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Put\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" path\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" secretData\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlogger\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Error\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Failed to write secret to Vault.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Path\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" path\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Error\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),` err\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlogger\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Info\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Successfully wrote secret to Vault.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Path\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" path\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// ========================================================================\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 2. Workflow - The orchestrator, the project manager\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// ========================================================================\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"SecretDistributionWorkflow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx workflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"error\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Set timeout options for our activities.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tao \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" workflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ActivityOptions\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tStartToCloseTimeout\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" time\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Second\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tctx \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" workflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"WithActivityOptions\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" ao\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlogger \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" workflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"GetLogger\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlogger\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Info\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Secret Distribution Workflow started.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Step 1: Call the activity to generate a new password.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" newPassword \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" workflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ExecuteActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"GeneratePassword\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Get\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"newPassword\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlogger\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Error\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Failed to generate password.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Error\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),` err\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlogger\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Info\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Successfully generated a new password.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// Step 2: Distribute the password to both \"regions\" concurrently.'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// We use an error channel to collect results from our concurrent tasks.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\terrorChan \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" workflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewChannel\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// A note on concurrency: We must use workflow.Go, not a standard Go routine.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// This allows Temporal to manage the concurrency in a deterministic way\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// that can be safely replayed if the worker crashes.\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Concurrent Task A: Write to East US\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tworkflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Go\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx workflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" workflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ExecuteActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"WriteSecretToVault\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"db/east-us\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" newPassword\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Get\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\terrorChan\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Send\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" fmt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Errorf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"failed to write to east-us: %w\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\terrorChan\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Send\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Send nil for success\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Concurrent Task B: Write to West US\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tworkflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Go\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx workflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" workflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ExecuteActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"WriteSecretToVault\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"db/west-us\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" newPassword\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Get\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\terrorChan\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Send\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" fmt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Errorf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"failed to write to west-us: %w\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\terrorChan\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Send\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Send nil for success\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Wait for both concurrent tasks to finish.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" errs \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"error\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" i\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"++\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" errResult \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"error\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\terrorChan\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Receive\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"errResult\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" errResult \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\terrs \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"append\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"errs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" errResult\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"errs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlogger\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Error\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"One or more distribution tasks failed.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Errors\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" errs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// This is where you would add compensation logic,\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// like an activity to delete the secrets that were already written.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" fmt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Errorf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"workflow failed with errors: %v\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" errs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlogger\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Info\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Workflow completed successfully! Secret distributed to all regions.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.h3,{id:\"step-three-create-and-run-the-worker\",children:[(0,n.jsx)(e.a,{href:\"#step-three-create-and-run-the-worker\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step Three: Create and Run the Worker\"]}),(0,n.jsx)(e.p,{children:\"The Worker is a background process that connects to the Temporal server. It listens for tasks and executes the workflow and activity code we just wrote.\"}),(0,n.jsxs)(e.p,{children:[\"Create a new folder \",(0,n.jsx)(e.code,{children:\"worker\"}),\" and place a \",(0,n.jsx)(e.code,{children:\"main.go\"}),\" file inside it.\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"worker/main.go\"}),\" Code:\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-go\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"package\"}),` main\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"log\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"github.com/hashicorp/vault/api\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"go.temporal.io/sdk/client\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"go.temporal.io/sdk/worker\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Import the workflow and activities from our root package\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttemporalvault \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"temporal-vault-demo\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 1. Create the Temporal client.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" client\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Dial\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"client\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Options\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Fatalln\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Unable to create Temporal client\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"defer\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Close\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 2. Create the Vault client.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// It's configured to automatically pick up the VAULT_ADDR and VAULT_TOKEN\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// environment variables, which is super handy for local dev.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tvaultClient\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" api\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewClient\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"api\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"DefaultConfig\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Fatalln\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Unable to create Vault client\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 3. Create a new Worker.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// \"secret-distribution-task-queue\" is the name of the list our Starter'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// will place jobs on.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tw \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" worker\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"New\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"secret-distribution-task-queue\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" worker\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Options\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 4. Register our Workflow and Activities with the Worker.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tactivities \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"temporalvault\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Activities\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"VaultClient\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" vaultClient\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tw\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"RegisterWorkflow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"temporalvault\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"SecretDistributionWorkflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tw\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"RegisterActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"activities\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"GeneratePassword\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tw\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"RegisterActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"activities\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"WriteSecretToVault\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 5. Start the Worker! It will now poll for tasks.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Println\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Starting Worker...\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" w\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Run\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"worker\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"InterruptCh\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Fatalln\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Unable to start Worker\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"A friendly reminder: the \",(0,n.jsx)(e.code,{children:'import \"temporal-vault-demo\"'}),\" line should match the module name from your \",(0,n.jsx)(e.code,{children:\"go mod init\"}),\" command.\"]}),(0,n.jsxs)(e.h3,{id:\"step-four-create-and-run-the-starter\",children:[(0,n.jsx)(e.a,{href:\"#step-four-create-and-run-the-starter\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step Four: Create and Run the Starter\"]}),(0,n.jsxs)(e.p,{children:['The Starter is a simple, one-off program whose only job is to tell Temporal, \"Hey, please kick off a new ',(0,n.jsx)(e.code,{children:\"SecretDistributionWorkflow\"}),' for me.\"']}),(0,n.jsxs)(e.p,{children:[\"Create another new folder \",(0,n.jsx)(e.code,{children:\"starter\"}),\", and add a \",(0,n.jsx)(e.code,{children:\"main.go\"}),\" file to it.\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"starter/main.go\"}),\" Code:\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-go\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"package\"}),` main\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"context\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"log\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"go.temporal.io/sdk/client\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttemporalvault \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"temporal-vault-demo\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" client\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Dial\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"client\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Options\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Fatalln\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Unable to create Temporal client\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"defer\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Close\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Define the options for our workflow.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// WorkflowID is a unique business-level ID for this specific run.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// TaskQueue must match the name the Worker is listening on.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tworkflowOptions \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" client\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"StartWorkflowOptions\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tID\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"secret-distribution-workflow-1\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tTaskQueue\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"secret-distribution-task-queue\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Start the workflow! This is an asynchronous operation.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Println\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Starting Secret Distribution Workflow...\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\twe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ExecuteWorkflow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Background\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" workflowOptions\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" temporalvault\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"SecretDistributionWorkflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Fatalln\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Unable to execute workflow\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Printf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Started workflow - WorkflowID: %s, RunID: %s\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" we\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"GetID\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" we\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"GetRunID\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Now, we'll wait for the workflow to complete.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Println\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Waiting for workflow to complete...\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" we\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Get\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Background\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Fatalln\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Workflow failed\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Println\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Workflow completed successfully!\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.h3,{id:\"step-five-run-and-verify\",children:[(0,n.jsx)(e.a,{href:\"#step-five-run-and-verify\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step Five: Run and Verify!\"]}),(0,n.jsx)(e.p,{children:\"You'll need two separate terminal windows (in addition to the ones running Temporal and Vault).\"}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Terminal 1 - Run the Worker\"}),\":\"]}),(0,n.jsx)(e.pre,{className:\"language-shell\",children:(0,n.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`ss@ss:~/temporal-vault-demo$ go run worker/main.go\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token number\",children:\"2025\"}),\"/07/08 \",(0,n.jsx)(e.span,{className:\"token number\",children:\"21\"}),\":12:33 INFO\\xA0 No logger configured \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),` temporal client. Created default one.\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token number\",children:\"2025\"}),\"/07/08 \",(0,n.jsx)(e.span,{className:\"token number\",children:\"21\"}),\":12:33 Starting Worker\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token number\",children:\"2025\"}),\"/07/08 \",(0,n.jsx)(e.span,{className:\"token number\",children:\"21\"}),\":12:33 INFO\\xA0 Started Worker Namespace default TaskQueue secret-distribution-task-queue WorkerID \",(0,n.jsx)(e.span,{className:\"token number\",children:\"160626\"}),`@ss@\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Terminal 2 - Run the Starter (after the Worker is running)\"}),\":\"]}),(0,n.jsx)(e.pre,{className:\"language-shell\",children:(0,n.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`ss@ss:~/temporal-vault-demo$ go run starter/main.go\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token number\",children:\"2025\"}),\"/07/08 \",(0,n.jsx)(e.span,{className:\"token number\",children:\"21\"}),\":12:56 INFO\\xA0 No logger configured \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),` temporal client. Created default one.\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token number\",children:\"2025\"}),\"/07/08 \",(0,n.jsx)(e.span,{className:\"token number\",children:\"21\"}),\":12:56 Starting Secret Distribution Workflow\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token number\",children:\"2025\"}),\"/07/08 \",(0,n.jsx)(e.span,{className:\"token number\",children:\"21\"}),`:12:56 Started workflow - WorkflowID: secret-distribution-workflow-1, RunID: 0197ea2b-0293-719a-9e21-c937d191147b\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token number\",children:\"2025\"}),\"/07/08 \",(0,n.jsx)(e.span,{className:\"token number\",children:\"21\"}),\":12:56 Waiting \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" workflow to complete\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token number\",children:\"2025\"}),\"/07/08 \",(0,n.jsx)(e.span,{className:\"token number\",children:\"21\"}),\":12:56 Workflow completed successfully\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Observation and Verification\"}),\":\"]}),(0,n.jsx)(e.p,{children:\"Now for the moment of truth. You can use the vault CLI in your terminal to see if the secrets were actually written.\"}),(0,n.jsx)(e.pre,{className:\"language-shell\",children:(0,n.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`ss@ss:~/temporal-vault-demo$ vault kv get secret/db/east-us\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Secret Path \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`secret/data/db/east-us\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Metadata \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Key\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 Value\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`---\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 -----\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"created_time\\xA0 \\xA0 \\xA0 \\xA0\",(0,n.jsx)(e.span,{className:\"token number\",children:\"2025\"}),`-07-08T13:12:56.746048772Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"custom_metadata\\xA0 \\xA0 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\"nil\",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`deletion_time\\xA0 \\xA0 \\xA0 n/a\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"destroyed\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"version\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" Data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Key\\xA0 \\xA0 \\xA0 \\xA0 \\xA0Value\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`---\\xA0 \\xA0 \\xA0 \\xA0 \\xA0-----\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`password\\xA0 \\xA0 GiAd@lEQ0lSaxdSP\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`ss@ss:~/temporal-vault-demo$ vault kv get secret/db/west-us\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Secret Path \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`secret/data/db/west-us\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Metadata \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Key\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 Value\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`---\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 -----\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"created_time\\xA0 \\xA0 \\xA0 \\xA0\",(0,n.jsx)(e.span,{className:\"token number\",children:\"2025\"}),`-07-08T13:12:56.746342827Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"custom_metadata\\xA0 \\xA0 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\"nil\",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`deletion_time\\xA0 \\xA0 \\xA0 n/a\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"destroyed\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"version\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" Data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Key\\xA0 \\xA0 \\xA0 \\xA0 \\xA0Value\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`---\\xA0 \\xA0 \\xA0 \\xA0 \\xA0-----\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`password\\xA0 \\xA0 GiAd@lEQ0lSaxdSP\n`})]})}),(0,n.jsxs)(e.p,{children:[\"Success! The same password in both locations. And if you check out the Temporal Web UI at \",(0,n.jsx)(e.a,{href:\"http://localhost:8233\",children:\"http://localhost:8233\"}),\", you'll see a beautiful record of our completed workflow.\"]}),(0,n.jsx)(l,{width:600,src:\"/static/images/general/temporal.png \"}),(0,n.jsxs)(e.p,{children:[\"It lets you focus on your business logic, while the robot project manager handles the messy reality of distributed systems. And trust me, after my \",(0,n.jsx)(e.code,{children:\"try...catch...fail\"}),\" incident, that's a promotion we could all use.\"]})]})}}var b=y;function v(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return T;})();\n;return Component;","toc":[{"value":"So, What is Temporal?","url":"#so-what-is-temporal","depth":2},{"value":"Example : The \"Cross-Region Key Rotation\" Workflow","url":"#example--the-cross-region-key-rotation-workflow","depth":2},{"value":"Step 1: Kicking Off the Project (Scheduling)","url":"#step-1-kicking-off-the-project-scheduling","depth":3},{"value":"Step 2: Generating the New Password (Executing a Task)","url":"#step-2-generating-the-new-password-executing-a-task","depth":3},{"value":"Step 3: Distributing the New Password (State Persistence)","url":"#step-3-distributing-the-new-password-state-persistence","depth":3},{"value":"Step 4: Waiting for Confirmation (Long-Running & Timeouts)","url":"#step-4-waiting-for-confirmation-long-running--timeouts","depth":3},{"value":"Step 5: Handling Failure (Recovery & Compensation)","url":"#step-5-handling-failure-recovery--compensation","depth":3},{"value":"Let's Build It! A Hands-On Temporal Project","url":"#lets-build-it-a-hands-on-temporal-project","depth":2},{"value":"Step Zero: Prep Your Dev Environment","url":"#step-zero-prep-your-dev-environment","depth":3},{"value":"Step One: Create the Go Project and Install Dependencies","url":"#step-one-create-the-go-project-and-install-dependencies","depth":3},{"value":"Step Two: Write the Workflow and Activities (The Core Logic)","url":"#step-two-write-the-workflow-and-activities-the-core-logic","depth":2},{"value":"Step Three: Create and Run the Worker","url":"#step-three-create-and-run-the-worker","depth":3},{"value":"Step Four: Create and Run the Starter","url":"#step-four-create-and-run-the-starter","depth":3},{"value":"Step Five: Run and Verify!","url":"#step-five-run-and-verify","depth":3}],"frontMatter":{"readingTime":{"text":"18 min read","minutes":17.015,"time":1020900,"words":3403},"slug":"general/temporal","fileName":"general/temporal.md","title":"An InfoSec Architect's First Taste of Temporal","date":"2025-07-08T00:00:00.000Z","tags":["Secrets Management"],"draft":false,"summary":"This is a therapy session for anyone traumatized by fragile scripts. I traded my `cron/try/catch` nightmares for a robot project manager named Temporal.","images":[]}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.72,"time":43200,"words":144},"slug":["default"],"fileName":"default.md","name":"Ted","avatar":"/static/images/avatar.jpg","occupation":"CISSP, CKS, AWS Certified Security  Specialty, Microsoft Cybersecurity Architect Expert","email":"nerd@supasaf.com","twitter":"https://twitter.com/supasaf","date":null}],"prev":{"title":"Consensus Algorithms Through the Eyes of an Infosec Architect","date":"2025-07-04T00:00:00.000Z","tags":["Architect"],"draft":false,"summary":"a.k.a. I wrote a Raft cluster in Go and accidentally learned a lot","images":[],"slug":"raft-algo"},"next":null},"__N_SSG":true}