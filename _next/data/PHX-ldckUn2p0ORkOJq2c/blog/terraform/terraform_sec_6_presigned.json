{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var d=Object.create;var i=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var t=a=>i(a,\"__esModule\",{value:!0});var N=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=>{t(a);for(var c in s)i(a,c,{get:s[c],enumerable:!0})},g=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of h(s))!u.call(a,n)&&n!==\"default\"&&i(a,n,{get:()=>s[n],enumerable:!(c=p(s,n))||c.enumerable});return a},y=a=>g(t(i(a!=null?d(m(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=N((S,o)=>{o.exports=_jsx_runtime});var v={};k(v,{default:()=>w,frontmatter:()=>_});var e=y(r()),_={title:\"Stop Making Your S3 Buckets Public! A Guide to Presigned URLs\",date:\"2025-11-15\",tags:[\"Terraform\",\"Cloud\",\"AWS\"],draft:!1,summary:\"Learn how to use S3 Presigned URLs to securely share private files without ever making your bucket public.\"};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({p:\"p\",strong:\"strong\",a:\"a\",h2:\"h2\",span:\"span\",ul:\"ul\",li:\"li\",code:\"code\",pre:\"pre\",ol:\"ol\"},a.components),{Image:l}=n;return l||f(\"Image\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.p,{children:['A developer needs to share a file from cloud storage. What do they do? They go to the S3 console, click \"Properties,\" \"Permissions,\" and set the bucket to... \"',(0,e.jsx)(n.strong,{children:\"Public\"}),'\".']}),(0,e.jsx)(n.p,{children:\"As a security guy, this is the moment my eye starts to twitch uncontrollably.\"}),(0,e.jsx)(n.p,{children:`Making a bucket \"public\" is the cloud equivalent of leaving your house keys taped to the front door with a giant \"COME ON IN!\" sign. It's a \"Resume-Generating Event,\" as in, you'll need to update your resume after you get fired.`}),(0,e.jsx)(n.p,{children:\"The other day at work, I ran into a classic version of this problem. Algorithm team has a new service (on Tencent Cloud, actually) that generates an image. This image needs to be seen by our end user, maybe internal staff or maybe even an external partner.\"}),(0,e.jsx)(n.p,{children:\"So, how do you let someone access one file in a private bucket, just one time, without giving them the keys to the entire kingdom?\"}),(0,e.jsxs)(n.p,{children:[\"The answer is simple and beautiful: \",(0,e.jsx)(n.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ShareObjectPreSignedURL.html\",children:\"Presigned URLs\"}),\".\"]}),(0,e.jsx)(n.p,{children:\"To prove how cool this is, I decided to build a minimal demo from scratch using my AWS Free Tier. (Hey, you gotta keep your hands dirty, right?)\"}),(0,e.jsxs)(n.h2,{id:\"what-the-heck-is-an-s3-presigned-url\",children:[(0,e.jsx)(n.a,{href:\"#what-the-heck-is-an-s3-presigned-url\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"What the Heck is an S3 Presigned URL?\"]}),(0,e.jsx)(n.p,{children:\"Think of it like a magical, single-use, self-destructing ticket to a VIP club.\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"The Club (Your S3 Bucket)\"}),\": Is 100% private. The bouncer (AWS) checks everyone at the door.\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"The Ticket (The Presigned URL)\"}),\": You (a trusted IAM identity) generate this special ticket. It has a cryptographic signature baked right into the URL query string.\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"The Rules\"}),': The signature basically tells the bouncer: \"This person is with me. Let them ',(0,e.jsx)(n.strong,{children:\"GET\"}),\" the file \",(0,e.jsx)(n.code,{children:\"order-123.jpg\"}),\"... but \",(0,e.jsx)(n.strong,{children:\"only for the next 5 minutes\"}),'.\"']})]}),(0,e.jsx)(n.p,{children:\"After 5 minutes, that URL is just a useless string of text (it gives a 403 Access Denied error).\"}),(0,e.jsx)(n.p,{children:\"In another words, your S3 bucket stays 100% private. (No, really. Don't you dare touch that public access block.)\"}),(0,e.jsx)(n.p,{children:\"You never share your permanent Access Keys. The signature in the URL is temporary.\"}),(0,e.jsx)(n.p,{children:\"Access is temporary. You set the expiration. 60 seconds? 10 minutes? You're the boss.\"}),(0,e.jsx)(n.p,{children:\"Access is specific. This URL might only work for a GET (download) or a PUT (upload), and only for one specific file.\"}),(0,e.jsxs)(n.h2,{id:\"building-the-fortress-with-terraform\",children:[(0,e.jsx)(n.a,{href:\"#building-the-fortress-with-terraform\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Building the Fortress (with Terraform)\"]}),(0,e.jsx)(n.p,{children:`In the modern cloud world, we don't \"click around in the console.\" That's called \"ClickOps,\" and it's how mistakes happen. We use Infrastructure as Code (IaC) to build our environment so it's repeatable and secure.`}),(0,e.jsx)(n.p,{children:\"Here\\u2019s my main.tf script to build a fortress-like S3 setup.\"}),(0,e.jsx)(n.pre,{className:\"language-hcl\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-hcl\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"terraform\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"required_providers\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"aws\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"source\"}),\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"hashicorp/aws\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"version\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"~> 5.0\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"provider\",(0,e.jsx)(n.span,{className:\"token type variable\",children:' \"aws\" '})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"region\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"us-east-1\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Generate a random suffix to keep the bucket name unique\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"random_id\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"suffix\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"byte_length\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Create the S3 bucket\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_s3_bucket\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"demo_bucket\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"bucket\"}),\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsxs)(n.span,{className:\"token string\",children:['\"presigned-demo-',(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"$\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"random_id\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"suffix\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"hex\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),'\"']}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"force_destroy\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Good for demos, NOT for prod!\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"tags\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"Purpose\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"PresignedURLDemo\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# BLOCK ALL PUBLIC ACCESS. This is the most important part.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_s3_bucket_public_access_block\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"demo_block\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"bucket\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_s3_bucket.demo_bucket.id\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"block_public_acls\"}),\"\\xA0 \\xA0 \\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"block_public_policy\"}),\"\\xA0 \\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"ignore_public_acls\"}),\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"restrict_public_buckets\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Enable server-side encryption by default\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_s3_bucket_server_side_encryption_configuration\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"demo_encryption\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"bucket\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_s3_bucket.demo_bucket.id\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"rule\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"apply_server_side_encryption_by_default\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"sse_algorithm\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"AES256\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Enable versioning (good practice)\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_s3_bucket_versioning\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"demo_versioning\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"bucket\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_s3_bucket.demo_bucket.id\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"versioning_configuration\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"status\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Enabled\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Add a lifecycle rule to delete demo files after 7 days\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_s3_bucket_lifecycle_configuration\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"demo_lifecycle\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"bucket\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_s3_bucket.demo_bucket.id\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"rule\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"id\"}),\"\\xA0 \\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"delete-after-7-days\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"status\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Enabled\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"filter\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"prefix\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Apply to all objects\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"expiration\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"days\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"7\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Create an IAM user (for demo purposes)\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_iam_user\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"presigned_user\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"name\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsxs)(n.span,{className:\"token string\",children:['\"presigned-demo-user-',(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"$\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"random_id\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"suffix\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"hex\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),'\"']}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"tags\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"Purpose\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"PresignedURLDemo\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Create a minimal IAM policy\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_iam_policy\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"presigned_policy\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"name\"}),\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsxs)(n.span,{className:\"token string\",children:['\"presigned-demo-policy-',(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"$\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"random_id\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"suffix\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"hex\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),'\"']}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"description\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Allow minimal S3 access for presigned URL demo\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"policy\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" jsonencode(\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"Version\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"2012-10-17\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"Statement\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"Effect\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Allow\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"Action\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3:GetObject\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3:PutObject\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"Resource\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsxs)(n.span,{className:\"token string\",children:['\"',(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"$\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"aws_s3_bucket\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"demo_bucket\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"arn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),'/*\"']}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Only on objects\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"Effect\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Allow\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"Action\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3:ListBucket\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"Resource\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" aws_s3_bucket.demo_bucket.arn \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Only on the bucket itself\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`)\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Attach the policy to the user\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_iam_user_policy_attachment\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"attach_policy\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"user\"}),\"\\xA0 \\xA0 \\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_iam_user.presigned_user.name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"policy_arn\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_iam_policy.presigned_policy.arn\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Create access keys for the demo user\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_iam_access_key\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"demo_key\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"user\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_iam_user.presigned_user.name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# --- Outputs ---\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"output\",(0,e.jsx)(n.span,{className:\"token type variable\",children:' \"bucket_name\" '})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"value\"}),\"\\xA0 \\xA0 \\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_s3_bucket.demo_bucket.bucket\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"description\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"S3 bucket name\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"output\",(0,e.jsx)(n.span,{className:\"token type variable\",children:' \"bucket_region\" '})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"value\"}),\"\\xA0 \\xA0 \\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_s3_bucket.demo_bucket.region\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"description\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"S3 bucket region\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"output\",(0,e.jsx)(n.span,{className:\"token type variable\",children:' \"access_key_id\" '})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"value\"}),\"\\xA0 \\xA0 \\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_iam_access_key.demo_key.id\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"description\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"AWS Access Key ID\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"sensitive\"}),\"\\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"output\",(0,e.jsx)(n.span,{className:\"token type variable\",children:' \"secret_access_key\" '})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"value\"}),\"\\xA0 \\xA0 \\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_iam_access_key.demo_key.secret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"description\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"AWS Secret Access Key\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"sensitive\"}),\"\\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"I run terraform apply, and poof! My environment is ready. Look at that beautiful, private, encrypted, and locked-down setup.\"}),(0,e.jsx)(l,{width:600,src:\"/static/images/terraform/s3_t_1.png\"}),(0,e.jsx)(l,{width:600,src:\"/static/images/terraform/s3_t_2.png\"}),(0,e.jsx)(l,{width:600,src:\"/static/images/terraform/s3_t_3.png\"}),(0,e.jsx)(l,{width:600,src:\"/static/images/terraform/s3_t_4.png\"}),(0,e.jsx)(l,{width:600,src:\"/static/images/terraform/s3_t_5.png\"}),(0,e.jsxs)(n.h2,{id:\"the-secret-handshake-with-python\",children:[(0,e.jsx)(n.a,{href:\"#the-secret-handshake-with-python\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),'The \"Secret Handshake\" (with Python)']}),(0,e.jsx)(n.p,{children:\"Okay, the fortress is built. Now I need to simulate the real business logic. I'll use Python and the boto3 library.\"}),(0,e.jsx)(n.p,{children:\"The script will do two things:\"}),(0,e.jsxs)(n.ol,{children:[(0,e.jsx)(n.li,{children:(0,e.jsxs)(n.p,{children:['Act 1 (Simulate the \"',(0,e.jsx)(n.strong,{children:\"Algorithm Team\"}),'\"): Generate a presigned URL to ',(0,e.jsx)(n.strong,{children:\"UPLOAD\"}),\" a file (PUT).\"]})}),(0,e.jsx)(n.li,{children:(0,e.jsxs)(n.p,{children:['Act 2 (Simulate the \"',(0,e.jsx)(n.strong,{children:\"End User\"}),'\"): Generate a presigned URL to ',(0,e.jsx)(n.strong,{children:\"DOWNLOAD\"}),\" that file (GET).\"]})})]}),(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-python\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"#!/usr/bin/env python3\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string triple-quoted-string\",children:`\"\"\"\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string triple-quoted-string\",children:`Simple S3 Presigned URL Demo\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string triple-quoted-string\",children:`Upload and download files using presigned URLs\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string triple-quoted-string\",children:'\"\"\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` boto3\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` requests\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# ========================================\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Configuration - Replace with your values\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# ========================================\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"BUCKET_NAME \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"presigned-demo-dd12e798\"'}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# I got this from my terraform output\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"REGION \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"us-east-1\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"LOCAL_FILE \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"ud.jpg\"'}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# A test image I have\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"OBJECT_KEY \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"ud.jpg\"'}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# The name it will have in S3\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# ========================================\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Main Demo\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# ========================================\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"main\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"=== S3 Presigned URL Demo ===\\\\n\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\xA0 \\xA0\\xA0\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Create S3 client\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:'f\"Creating S3 client for region: '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"REGION\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Boto3 will find the keys from my ~/.aws/credentials file\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 s3_client \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" boto3\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"client\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'s3'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" region_name\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"REGION\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\xA0 \\xA0\\xA0\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Step 1: Generate presigned URL for upload (PUT)\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string-interpolation\",children:(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\\\n1. Generating presigned URL for upload (expires in 600 seconds)...\"'})}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 upload_url \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" s3_client\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"generate_presigned_url\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 ClientMethod\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'put_object'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 Params\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'Bucket'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" BUCKET_NAME\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'Key'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" OBJECT_KEY\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'ContentType'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'image/jpeg'\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Important for uploads!\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 ExpiresIn\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"600\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# 10 minutes\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\xA0 \\xA0Upload URL: '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"upload_url\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token format-spec\",children:\"80]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'...\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\xA0 \\xA0\\xA0\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Step 2: Upload file using presigned URL\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# We use 'requests' here to act like a client that does NOT have AWS keys\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\\\n2. Uploading '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"LOCAL_FILE\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:' using presigned URL...\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"with\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"open\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"LOCAL_FILE\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'rb'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 response \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" requests\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"put\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 upload_url\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 data\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 headers\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'Content-Type'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'image/jpeg'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\xA0 \\xA0\\xA0\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" response\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"status_code \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"200\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string-interpolation\",children:(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\xA0 \\xA0\\u2713 Upload successful!\"'})}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"else\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\xA0 \\xA0\\u2717 Upload failed: '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"response\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"status_code\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\xA0 \\xA0Error: '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"response\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"text\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\xA0 \\xA0\\xA0\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Step 3: Generate presigned URL for download (GET)\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string-interpolation\",children:(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\\\n3. Generating presigned URL for download (expires in 300 seconds)...\"'})}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 download_url \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" s3_client\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"generate_presigned_url\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 ClientMethod\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'get_object'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 Params\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'Bucket'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" BUCKET_NAME\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'Key'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OBJECT_KEY\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 ExpiresIn\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"300\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# 5 minutes\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 _ \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\xA0 \\xA0Download URL: '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"download_url\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token format-spec\",children:\"80]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'...\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\xA0 \\xA0\\xA0\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Step 4: Download file using presigned URL\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string-interpolation\",children:(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\\\n4. Downloading file using presigned URL...\"'})}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 response \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" requests\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"get\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"download_url\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\xA0 \\xA0\\xA0\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" response\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"status_code \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"200\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 output_file \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"downloaded_ud.jpg\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"with\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"open\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"output_file\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'wb'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"write\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"response\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"content\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string-interpolation\",children:(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\xA0 \\xA0\\u2713 Download successful!\"'})}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\xA0 \\xA0File saved as: '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"output_file\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\xA0 \\xA0File size: '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"response\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"content\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:' bytes\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"else\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:'f\"\\xA0 \\xA0\\u2717 Download failed: '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"response\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"status_code\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"__main__\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 main\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"And look at the result! It just works.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"base\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` ss@ss:~/s3_1113$ python3 demo.py\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" S3 Presigned URL Demo \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Creating S3 client \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),` region: us-east-1\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\". Generating presigned URL \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" upload \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"expires \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"600\"}),\" seconds\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0Upload URL: https://presigned-demo-dd12e798.s3.amazonaws.com/ud.jpg?AWSAccessKeyId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"AKIAXDJLS\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),\". Uploading ud.jpg using presigned URL\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0\\u2713 Upload successful\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),\". Generating presigned URL \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" download \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"expires \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"300\"}),\" seconds\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0Download URL: https://presigned-demo-dd12e798.s3.amazonaws.com/ud.jpg?AWSAccessKeyId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"AKIAXDJLS\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),\". Downloading \",(0,e.jsx)(n.span,{className:\"token function\",children:\"file\"}),\" using presigned URL\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0\\u2713 Download successful\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\xA0 \\xA0File saved as: downloaded_ud.jpg\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0File size: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"65049\"}),` bytes\n`]})]})}),(0,e.jsx)(n.p,{children:\"The requests library, which has zero idea about my AWS keys, was able to both upload and download a file to my 100% private S3 bucket. That's the magic.\"}),(0,e.jsxs)(n.h2,{id:\"ok-but-how-do-you-do-this-in-production\",children:[(0,e.jsx)(n.a,{href:\"#ok-but-how-do-you-do-this-in-production\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"OK, But How Do You Do This in Production?\"]}),(0,e.jsxs)(n.p,{children:[\"My demo was great, but I used a long-term \",(0,e.jsx)(n.strong,{children:\"IAM User\"}),\" key (aws_iam_access_key) stored on my laptop.\"]}),(0,e.jsxs)(n.p,{children:[\"In a real production environment... \",(0,e.jsx)(n.strong,{children:\"NEVER DO THIS\"}),\".\"]}),(0,e.jsx)(n.p,{children:\"Storing static, long-lived access keys in your application code is a massive security risk. If those keys ever leak, a hacker has a permanent key to your S3 bucket.\"}),(0,e.jsxs)(n.p,{children:['In a real, \"grown-up\" architecture, you use a \"',(0,e.jsx)(n.strong,{children:\"Signing Service\"}),'\" pattern.']}),(0,e.jsxs)(n.ol,{children:[(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Create a dedicated AWS Lambda function\"}),`. Its only job is to generate these presigned URLs. Let's call it the \"URL-Signing-Guy.\"`]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Give the Lambda an IAM Role (not a User!)\"}),'. This role is a temporary identity that the Lambda \"wears\" when it runs. This role has a very strict policy: ',(0,e.jsx)(n.code,{children:\"s3:GetObject\"}),\" and \",(0,e.jsx)(n.code,{children:\"s3:PutObject\"}),\" only for your specific bucket.\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Put an API Gateway in front of the Lambda\"}),\". Your main application (the algorithm service) doesn't call S3 directly. It calls your own secure API endpoint (e.g., POST \",(0,e.jsx)(n.code,{children:\"/api/v1/get-upload-url\"}),\").\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Strengthen the S3 Bucket Policy\"}),`. This is the expert-level move. You add a Bucket Policy to S3 that says: \"I will only accept GetObject or PutObject requests IF they come from the 'URL-Signing-Guy' Lambda's IAM Role.\"`]})]})]})}}var w=b;function f(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return v;})();\n;return Component;","toc":[{"value":"What the Heck is an S3 Presigned URL?","url":"#what-the-heck-is-an-s3-presigned-url","depth":2},{"value":"Building the Fortress (with Terraform)","url":"#building-the-fortress-with-terraform","depth":2},{"value":"The \"Secret Handshake\" (with Python)","url":"#the-secret-handshake-with-python","depth":2},{"value":"OK, But How Do You Do This in Production?","url":"#ok-but-how-do-you-do-this-in-production","depth":2}],"frontMatter":{"readingTime":{"text":"13 min read","minutes":12.74,"time":764400,"words":2548},"slug":"terraform/terraform_sec_6_presigned","fileName":"terraform/terraform_sec_6_presigned.md","title":"Stop Making Your S3 Buckets Public! A Guide to Presigned URLs","date":"2025-11-15T00:00:00.000Z","tags":["Terraform","Cloud","AWS"],"draft":false,"summary":"Learn how to use S3 Presigned URLs to securely share private files without ever making your bucket public."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.72,"time":43200,"words":144},"slug":["default"],"fileName":"default.md","name":"Ted","avatar":"/static/images/avatar.jpg","occupation":"CISSP, CKS, AWS Certified Security  Specialty, Microsoft Cybersecurity Architect Expert","email":"nerd@supasaf.com","twitter":"https://twitter.com/supasaf","date":null}],"prev":{"title":"InfoSec Architect 102-Service Accounts in the Linux Universe","date":"2025-10-08T00:00:00.000Z","tags":["Architect"],"draft":false,"summary":"This hands-on guide walks you through setting up Kerberos and LDAP on Ubuntu to achieve secure, password-free database access for service accounts, inspired by real-world practices at Uber.","images":[],"slug":"general/kerberos_ldap"},"next":null},"__N_SSG":true}