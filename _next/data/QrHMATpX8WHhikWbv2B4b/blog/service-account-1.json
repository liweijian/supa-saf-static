{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var l=Object.create;var a=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var o=i=>a(i,\"__esModule\",{value:!0});var g=(i,r)=>()=>(r||i((r={exports:{}}).exports,r),r.exports),w=(i,r)=>{o(i);for(var t in r)a(i,t,{get:r[t],enumerable:!0})},y=(i,r,t)=>{if(r&&typeof r==\"object\"||typeof r==\"function\")for(let n of u(r))!m.call(i,n)&&n!==\"default\"&&a(i,n,{get:()=>r[n],enumerable:!(t=h(r,n))||t.enumerable});return i},v=i=>y(o(a(i!=null?l(p(i)):{},\"default\",i&&i.__esModule&&\"default\"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i);var d=g((N,c)=>{c.exports=_jsx_runtime});var T={};w(T,{default:()=>f,frontmatter:()=>b});var e=v(d()),b={title:\"InfoSec architect 101-Service account from prehistory\",date:\"2025-07-01\",tags:[\"Architect\"],draft:!1,summary:\"Service accounts may sound boring, but they\\u2019re the unsung heroes of secure automation. In this post, we time-travel back to the prehistoric age of Windows domains to see how service accounts and Kerberos work together to avoid hardcoded passwords and security nightmares.\",images:[]};function S(i={}){let{wrapper:r}=i.components||{};return r?(0,e.jsx)(r,Object.assign({},i,{children:(0,e.jsx)(t,{})})):t();function t(){let n=Object.assign({p:\"p\",strong:\"strong\",h2:\"h2\",a:\"a\",span:\"span\",code:\"code\",ul:\"ul\",li:\"li\",pre:\"pre\",br:\"br\",h3:\"h3\",ol:\"ol\",table:\"table\",thead:\"thead\",tr:\"tr\",th:\"th\",tbody:\"tbody\",td:\"td\",blockquote:\"blockquote\"},i.components),{Image:s}=n;return s||k(\"Image\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.p,{children:\"I\\u2019ve worked in the industry for many, many years. I used to believe that \\u201Cservice accounts\\u201D were basic knowledge for anyone in this field. But over time, I\\u2019ve discovered that many people\\u2014even developers and system administrators\\u2014don\\u2019t really understand what service accounts are or how they work.\"}),(0,e.jsx)(n.p,{children:\"In this blog post, I want to explain service accounts using a hands-on approach. I\\u2019ll use a simple Windows-based lab environment to show how service accounts work in a traditional Microsoft IT setup.\"}),(0,e.jsxs)(n.p,{children:[\"Yep, I know this feels like \",(0,e.jsx)(n.strong,{children:\"technology from the Stone Age\"}),\"\\u2014I\\u2019ll write another post in the future about service accounts in the cloud.\"]}),(0,e.jsxs)(n.h2,{id:\"so-why-do-we-need-service-accounts\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#so-why-do-we-need-service-accounts\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"So, why Do We Need Service Accounts?\"]}),(0,e.jsx)(n.p,{children:\"Imagine this situation: You\\u2019re an IT admin at a company. Hundreds of employees need to access systems like databases, file servers, and email every day. If every system has its own username and password, it becomes a nightmare to manage.\"}),(0,e.jsx)(n.p,{children:\"Even worse, some backend applications need to connect to a database automatically.\"}),(0,e.jsxs)(n.p,{children:[\"Should we store the database password inside the code? -- \",(0,e.jsx)(n.strong,{children:\"Of course not!\"}),\" That\\u2019s just asking for trouble.\"]}),(0,e.jsx)(n.p,{children:\"This is where service accounts come in.\"}),(0,e.jsxs)(n.h2,{id:\"the-pain-of-not-using-service-accounts\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#the-pain-of-not-using-service-accounts\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"The Pain of Not Using Service Accounts\"]}),(0,e.jsx)(n.p,{children:\"In theory, we can connect to SQL Server like this:\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"sqlcmd -S ServerName -U username -P password\"})}),(0,e.jsx)(n.p,{children:\"This method brings all kinds of headaches:\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"Passwords are stored in config files or connection strings. If the password changes, you need to update all systems.\"}),(0,e.jsx)(n.li,{children:\"Developers and DevOps may see the plain text passwords. Log files may accidentally capture them too.\"}),(0,e.jsx)(n.li,{children:\"Many apps share the same DB account\\u2014you can't track who\\u2019s doing what, and fine-grained access control becomes impossible.\"}),(0,e.jsx)(n.li,{children:\"Every new app or server needs new credentials, and you have to manage them manually on each machine.\"})]}),(0,e.jsxs)(n.h2,{id:\"what-is-a-service-account\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#what-is-a-service-account\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"What Is a Service Account?\"]}),(0,e.jsxs)(n.p,{children:[\"In a Windows domain environment, a \",(0,e.jsx)(n.strong,{children:\"service account\"}),\" is a special type of user account created to run applications or services. It\\u2019s not for logging in like a normal user\\u2014it gives services their own digital identity.\"]}),(0,e.jsx)(n.p,{children:\"Each service has its own account\\u2014just like each employee has an ID card.\"}),(0,e.jsx)(n.p,{children:\"Example:\"}),(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`DistinguishedName : CN=sql svc.,CN=Users,DC=supasaf,DC=com\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`SamAccountName    : sqlsvc\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`UserPrincipalName : sqlsvc@supasaf.com\n`})]})}),(0,e.jsx)(s,{width:580,src:\"/static/images/general/sqlsvc.png\"}),(0,e.jsxs)(n.p,{children:[\"You can give a service account \",(0,e.jsx)(n.strong,{children:\"only the access it needs\\u2014nothing more.\"})]}),(0,e.jsxs)(n.p,{children:[\"Because it doesn\\u2019t log in like a human user, it\\u2019s more secure.\",(0,e.jsx)(n.br,{}),\"Service accounts also work beautifully with \",(0,e.jsx)(n.strong,{children:\"Kerberos\"}),\", a secure way to authenticate without using passwords.\"]}),(0,e.jsxs)(n.p,{children:[\"But wait\\u2014what is \",(0,e.jsx)(n.strong,{children:\"Kerberos\"}),\"?\"]}),(0,e.jsxs)(n.h2,{id:\"the-technology-behind-kerberos\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#the-technology-behind-kerberos\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"The Technology Behind: Kerberos\"]}),(0,e.jsx)(n.p,{children:\"Kerberos is a network authentication protocol used in Windows domains. It uses symmetric encryption and a ticket-based system. Sounds fancy, right? But it\\u2019s actually pretty simple (well\\u2026 sort of).\"}),(0,e.jsx)(n.p,{children:\"Kerberos has three main components:\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"KDC (Key Distribution Center)\"}),\" \\u2013 gives out keys and tickets\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"AS (Authentication Server)\"}),\" \\u2013 checks your identity\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"TGS (Ticket Granting Server)\"}),\" \\u2013 gives you access to services\"]})]}),(0,e.jsxs)(n.p,{children:[\"In a Windows domain, all three live on the same machine: the \",(0,e.jsx)(n.strong,{children:\"Domain Controller (DC)\"}),\". So really, it\\u2019s just \",(0,e.jsx)(n.strong,{children:\"Active Directory in disguise\"}),\" :)\"]}),(0,e.jsxs)(n.h3,{id:\"the-authentication-flow-with-bad-ipad-drawing-sorry\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#the-authentication-flow-with-bad-ipad-drawing-sorry\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"The Authentication Flow (with bad iPad drawing, sorry!)\"]}),(0,e.jsxs)(n.ol,{children:[(0,e.jsxs)(n.li,{children:[\"User logs in and gets a \",(0,e.jsx)(n.strong,{children:\"TGT (Ticket Granting Ticket)\"})]}),(0,e.jsxs)(n.li,{children:[\"User uses the TGT to request a \",(0,e.jsx)(n.strong,{children:\"SGT (Service Granting Ticket)\"}),\" from the TGS\"]}),(0,e.jsx)(n.li,{children:\"User sends the SGT to the service (like SQL) to get access\\u2014no password needed\"})]}),(0,e.jsx)(s,{width:580,src:\"/static/images/general/ker_flow.jpg\"}),(0,e.jsxs)(n.h3,{id:\"important-kerberos-concepts-spn-tgt-and-sgt\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#important-kerberos-concepts-spn-tgt-and-sgt\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Important Kerberos Concepts: SPN, TGT, and SGT\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"SPN (Service Principal Name)\"}),\": A unique name for a service in the domain.\"]}),(0,e.jsxs)(n.p,{children:[\"Example: \",(0,e.jsx)(n.code,{children:\"MSSQLSvc/SupaServer.supasaf.com:SQLEXPRESS\"})]}),(0,e.jsxs)(n.ul,{children:[(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"MSSQLSvc\"}),\": The type of service (SQL Server)\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"SupaServer\"}),\": Hostname\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"SQLEXPRESS\"}),\": SQL instance name\"]})]}),(0,e.jsxs)(n.p,{children:[\"SPNs must be \",(0,e.jsx)(n.strong,{children:\"set correctly\"}),\" for Kerberos to work properly.\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"TGT (Ticket Granting Ticket)\"}),\": The first ticket you get when you log into the domain.\"]}),(0,e.jsx)(n.p,{children:\"Example:\"}),(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`Client: Test User @ SUPASAF.COM Server: krbtgt/SUPASAF.COM Flags: forwardable, renewable, initial, preauth\n`})})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"SGT (Service Granting Ticket)\"}),\": Used to access actual services like SQL or LDAP.\"]}),(0,e.jsx)(n.p,{children:\"Example:\"}),(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`Client: Test User @ SUPASAF.COM Server: LDAP/SupaServer.supasaf.com/supasaf.com Flags: forwardable, preauth, ok as delegate\n`})})}),(0,e.jsx)(n.p,{children:\"No passwords, no headaches\\u2014just tickets!\"}),(0,e.jsxs)(n.h2,{id:\"lab-demo-passwordless-sql-authentication-with-service-account\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#lab-demo-passwordless-sql-authentication-with-service-account\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Lab Demo: Passwordless SQL Authentication with Service Account\"]}),(0,e.jsx)(n.p,{children:\"To show how all this works, I built a simple test environment using Hyper-V:\"}),(0,e.jsxs)(n.table,{children:[(0,e.jsx)(n.thead,{children:(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.th,{children:\"Machine Name\"}),(0,e.jsx)(n.th,{children:\"OS\"}),(0,e.jsx)(n.th,{children:\"Role\"})]})}),(0,e.jsxs)(n.tbody,{children:[(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:\"SupaServer\"}),(0,e.jsx)(n.td,{children:\"Windows Server 2019\"}),(0,e.jsx)(n.td,{children:\"AD Domain Controller + SQL Server\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:\"SupaClient\"}),(0,e.jsx)(n.td,{children:\"Windows 10\"}),(0,e.jsxs)(n.td,{children:[\"Domain-joined client using \",(0,e.jsx)(n.code,{children:\"sqlcmd\"})]})]})]})]}),(0,e.jsx)(s,{width:300,src:\"/static/images/general/hyperv_sqlcmd.png\"}),(0,e.jsxs)(n.p,{children:[\"If all goes well, we can connect to SQL Server using \",(0,e.jsx)(n.code,{children:\"sqlcmd\"}),\", without typing any password.\"]}),(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`sqlcmd -S SupaServer.supasaf.com\\\\SQLEXPRESS -E\n`})})}),(0,e.jsxs)(n.p,{children:[\"Thanks to \",(0,e.jsx)(n.strong,{children:\"Kerberos\"}),\" and the \",(0,e.jsx)(n.strong,{children:\"service account\"}),\", this works securely and without any hardcoded password.\"]}),(0,e.jsx)(s,{width:200,src:\"/static/images/general/sqlsvr_cmd.png\"}),(0,e.jsxs)(n.h3,{id:\"bonus-tip-the-klist-command\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#bonus-tip-the-klist-command\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Bonus Tip: The \",(0,e.jsx)(n.code,{children:\"klist\"}),\" Command\"]}),(0,e.jsxs)(n.p,{children:[\"The \",(0,e.jsx)(n.code,{children:\"klist\"}),\" command is a built-in Windows tool used to \",(0,e.jsx)(n.strong,{children:\"view and manage Kerberos tickets\"}),\".\"]}),(0,e.jsxs)(n.p,{children:[\"When you log into a Windows domain, the system automatically gets a \",(0,e.jsx)(n.strong,{children:\"TGT (Ticket Granting Ticket)\"}),\". Later, when you access services like SQL Server or LDAP, it requests \",(0,e.jsx)(n.strong,{children:\"SGTs (Service Granting Tickets)\"}),\" from the domain controller.\"]}),(0,e.jsxs)(n.p,{children:[\"All these tickets are stored in your session\\u2014and you can see them with \",(0,e.jsx)(n.code,{children:\"klist\"}),\".\"]}),(0,e.jsx)(s,{width:380,src:\"/static/images/general/klist.png\"}),(0,e.jsxs)(n.h2,{id:\"final-thoughts-why-hands-on-is-still-important\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#final-thoughts-why-hands-on-is-still-important\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Final Thoughts: Why Hands-On Is Still Important\"]}),(0,e.jsxs)(n.p,{children:[\"We live in the age of AI. Yes, you can ask AI to explain anything. But I believe there\\u2019s a big difference between \",(0,e.jsx)(n.strong,{children:\"reading\"}),\" something and \",(0,e.jsx)(n.strong,{children:\"doing\"}),\" something.\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"Knowledge becomes real when it turns into muscle memory.\"})}),(0,e.jsx)(n.p,{children:\"So go ahead\\u2014build a tiny lab, break things, and make Kerberos your best friend (or at least a friendly ghost from the 80s).\"})]})}}var f=S;function k(i,r){throw new Error(\"Expected \"+(r?\"component\":\"object\")+\" `\"+i+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return T;})();\n;return Component;","toc":[{"value":"So, why Do We Need Service Accounts?","url":"#so-why-do-we-need-service-accounts","depth":2},{"value":"The Pain of Not Using Service Accounts","url":"#the-pain-of-not-using-service-accounts","depth":2},{"value":"What Is a Service Account?","url":"#what-is-a-service-account","depth":2},{"value":"The Technology Behind: Kerberos","url":"#the-technology-behind-kerberos","depth":2},{"value":"The Authentication Flow (with bad iPad drawing, sorry!)","url":"#the-authentication-flow-with-bad-ipad-drawing-sorry","depth":3},{"value":"Important Kerberos Concepts: SPN, TGT, and SGT","url":"#important-kerberos-concepts-spn-tgt-and-sgt","depth":3},{"value":"Lab Demo: Passwordless SQL Authentication with Service Account","url":"#lab-demo-passwordless-sql-authentication-with-service-account","depth":2},{"value":"Bonus Tip: The klist Command","url":"#bonus-tip-the-klist-command","depth":3},{"value":"Final Thoughts: Why Hands-On Is Still Important","url":"#final-thoughts-why-hands-on-is-still-important","depth":2}],"frontMatter":{"readingTime":{"text":"5 min read","minutes":4.43,"time":265800,"words":886},"slug":"service-account-1","fileName":"service-account-1.md","title":"InfoSec architect 101-Service account from prehistory","date":"2025-07-01T00:00:00.000Z","tags":["Architect"],"draft":false,"summary":"Service accounts may sound boring, but they’re the unsung heroes of secure automation. In this post, we time-travel back to the prehistoric age of Windows domains to see how service accounts and Kerberos work together to avoid hardcoded passwords and security nightmares.","images":[]}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.72,"time":43200,"words":144},"slug":["default"],"fileName":"default.md","name":"Ted","avatar":"/static/images/avatar.jpg","occupation":"CISSP, CKS, AWS Certified Security – Specialty, Microsoft Cybersecurity Architect Expert","email":"nerd@supasaf.com","twitter":"https://twitter.com/supasaf","date":null}],"prev":{"title":"Encrypting DynamoDB with AWS KMS: A Secure and Easy Guide","date":"2023-06-30T00:00:00.000Z","tags":["Terraform","Cloud","AWS"],"draft":false,"summary":"Discover how to use Terraform and AWS Key Management Service (KMS) to encrypt DynamoDB tables and enhance cybersecurity.","slug":"terraform/terraform_sec_5_kms_dynamodb"},"next":{"title":"Consensus Algorithms Through the Eyes of an Infosec Architect","date":"2025-07-04T00:00:00.000Z","tags":["Architect"],"draft":false,"summary":"a.k.a. I wrote a Raft cluster in Go and accidentally learned a lot","images":[],"slug":"raft-algo"}},"__N_SSG":true}