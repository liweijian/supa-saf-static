<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>Stop Hand-Crafting Tokens</title><meta name="robots" content="follow, index"/><meta name="description" content="Stop using hard-coded tokens like it&#x27;s 2007: A deep dive into securing microservices with OAuth 2.0 Client Credentials and the magic of JWKS key rotation."/><meta property="og:url" content="https://www.supasaf.com/blog/general/oauth2_jwks"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Cybersecurity, Cloud and Compiler"/><meta property="og:description" content="Stop using hard-coded tokens like it&#x27;s 2007: A deep dive into securing microservices with OAuth 2.0 Client Credentials and the magic of JWKS key rotation."/><meta property="og:title" content="Stop Hand-Crafting Tokens"/><meta property="og:image" content="https://www.supasaf.com/static/images/twitter-card.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="Stop Hand-Crafting Tokens"/><meta name="twitter:description" content="Stop using hard-coded tokens like it&#x27;s 2007: A deep dive into securing microservices with OAuth 2.0 Client Credentials and the magic of JWKS key rotation."/><meta name="twitter:image" content="https://www.supasaf.com/static/images/twitter-card.png"/><link rel="canonical" href="https://www.supasaf.com/blog/general/oauth2_jwks"/><meta property="article:published_time" content="2025-11-22T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.supasaf.com/blog/general/oauth2_jwks"
  },
  "headline": "Stop Hand-Crafting Tokens",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://www.supasaf.com/static/images/twitter-card.png"
    }
  ],
  "datePublished": "2025-11-22T00:00:00.000Z",
  "dateModified": "2025-11-22T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Ted"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Supa Safe",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.supasaf.com/static/images/logo2.png"
    }
  },
  "description": "Stop using hard-coded tokens like it's 2007: A deep dive into securing microservices with OAuth 2.0 Client Credentials and the magic of JWKS key rotation."
}</script><meta name="next-head-count" content="20"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/52032488e305abd8.css" as="style"/><link rel="stylesheet" href="/_next/static/css/52032488e305abd8.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-7bf052786ac70438.js" defer=""></script><script src="/_next/static/chunks/main-80446c6fe86f961e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c8c0eb7eb758c19d.js" defer=""></script><script src="/_next/static/chunks/410-35c4fb535edd9439.js" defer=""></script><script src="/_next/static/chunks/1-53b2bdc23927c90b.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-0728882d0f489132.js" defer=""></script><script src="/_next/static/E96RjgNfzLGDnuWZMjXP-/_buildManifest.js" defer=""></script><script src="/_next/static/E96RjgNfzLGDnuWZMjXP-/_ssgManifest.js" defer=""></script><script src="/_next/static/E96RjgNfzLGDnuWZMjXP-/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Supa Safe" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g stroke-width="1.5" fill="none"><path stroke="#93a3a9" vector-effect="non-scaling-stroke" d="M255.59 32.64q-1.42-.7-3.54-1.73a1.5 1.49-45.2 0 0-1.32.01q-50.57 24.94-105.46 35.16Q99.16 74.67 52.7 75a.96.95-89.7 0 0-.95.95q-.16 35.05.24 69.05.56 47.23 9.78 93.54 22.44 112.62 103.44 192.11 7.03 6.89 14.68 13.57 32.68 28.51 70.66 50.1a1.23 1.23-45.1 0 0 1.24 0q40.62-23.16 75.25-54.53Q412.88 362.01 438 248.5q10.21-46.13 12.25-95.75.57-13.88.19-77.19a.51.5-89.4 0 0-.49-.51q-52.56-.84-96.7-10.05-28.79-6.01-56.65-15.41-21.08-7.11-41.01-16.95"></path><path stroke="#3b777e" vector-effect="non-scaling-stroke" d="M255.83 59.14q-2.08-.89-3.82-1.68a2.11 2.1 45.2 0 0-1.72-.01q-39.78 17.64-81.04 27.05Q122.6 95.15 74.8 97.54a.53.51 88.9 0 0-.49.53q-.09 23.34-.07 46.68.01 11.6.53 19.99 2.46 39.82 11.48 80.26 11.03 49.46 34.97 92.77 21.15 38.27 51.8 69.46 34.34 34.95 77.32 60.62a1.3 1.3 90 0 0 1.32 0q43.02-25.62 77.21-60.73 64.32-66.08 85.64-156.07 9.17-38.71 12.3-78.32.7-8.83 1-19.97.75-26.89.43-54.51a.73.72-89.2 0 0-.69-.72q-55.89-2.9-109.45-16.98-31.93-8.4-62.27-21.41"></path><path stroke="#a7d3d4" vector-effect="non-scaling-stroke" d="M202.69 315.81q19.99 18.66 48.13 35.43a.83.83 90 0 0 .86 0q21.29-12.65 40.29-28.42 9.61-7.98 14.13-14.06 11.65-15.69 11.65-35.76v-90.98a.52.52 90 0 0-.52-.52l-132.42.06a.5.49 0 0 0-.5.49q.32 45.48.38 90.95.03 26.05 18 42.81"></path><path stroke="#93a3aa" vector-effect="non-scaling-stroke" d="M195.06 187.52q-1.81-.09-4.01.03a.59.58 88.5 0 0-.55.59v71.12q0 16.12.49 19.97 2.71 21.36 19.85 35.93 18.84 16.01 39.98 28.83a.83.83 90 0 0 .86 0q19.76-11.9 38.88-27.93 20.76-17.39 20.83-44.56.11-41.38.11-83.55a.45.45 45 0 0-.45-.45q-55.89-.11-111.98.18-.5 0-4.01-.16"></path><path stroke="#93a3aa" vector-effect="non-scaling-stroke" d="m250.65 258.4-41.2-40.58q-.68-.67-.69.29l-.26 27.64a1.18 1.16-67.2 0 0 .34.85l41.72 41.83a.63.62-44.7 0 0 .89 0l41.45-41.58a1.28 1.17 69.8 0 0 .35-.85l.19-27.82q.01-1.24-.87-.38l-41.21 40.6a.51.5-44.6 0 1-.71 0"></path></g><path fill="#fffefe" d="M0 0h512v512H0V0Zm255.59 32.64q-1.42-.7-3.54-1.73a1.5 1.49-45.2 0 0-1.32.01q-50.57 24.94-105.46 35.16Q99.16 74.67 52.7 75a.96.95-89.7 0 0-.95.95q-.16 35.05.24 69.05.56 47.23 9.78 93.54 22.44 112.62 103.44 192.11 7.03 6.89 14.68 13.57 32.68 28.51 70.66 50.1a1.23 1.23-45.1 0 0 1.24 0q40.62-23.16 75.25-54.53Q412.88 362.01 438 248.5q10.21-46.13 12.25-95.75.57-13.88.19-77.19a.51.5-89.4 0 0-.49-.51q-52.56-.84-96.7-10.05-28.79-6.01-56.65-15.41-21.08-7.11-41.01-16.95Z"></path><path fill="#274754" d="M255.59 32.64q19.93 9.84 41.01 16.95 27.86 9.4 56.65 15.41 44.14 9.21 96.7 10.05a.51.5-89.4 0 1 .49.51q.38 63.31-.19 77.19-2.04 49.62-12.25 95.75-25.12 113.51-110.96 191.29-34.63 31.37-75.25 54.53a1.23 1.23-44.4 0 1-1.24 0q-37.98-21.59-70.66-50.1-7.65-6.68-14.68-13.57-81-79.49-103.44-192.11-9.22-46.31-9.78-93.54-.4-34-.24-69.05a.96.95-89.7 0 1 .95-.95q46.46-.33 92.57-8.92 54.89-10.22 105.46-35.16a1.5 1.49-45.2 0 1 1.32-.01q2.12 1.03 3.54 1.73Zm.24 26.5q-2.08-.89-3.82-1.68a2.11 2.1 45.2 0 0-1.72-.01q-39.78 17.64-81.04 27.05Q122.6 95.15 74.8 97.54a.53.51 88.9 0 0-.49.53q-.09 23.34-.07 46.68.01 11.6.53 19.99 2.46 39.82 11.48 80.26 11.03 49.46 34.97 92.77 21.15 38.27 51.8 69.46 34.34 34.95 77.32 60.62a1.3 1.3 90 0 0 1.32 0q43.02-25.62 77.21-60.73 64.32-66.08 85.64-156.07 9.17-38.71 12.3-78.32.7-8.83 1-19.97.75-26.89.43-54.51a.73.72-89.2 0 0-.69-.72q-55.89-2.9-109.45-16.98-31.93-8.4-62.27-21.41Z"></path><path fill="#4ea7a8" d="M255.83 59.14q30.34 13.01 62.27 21.41 53.56 14.08 109.45 16.98a.73.72-89.2 0 1 .69.72q.32 27.62-.43 54.51-.3 11.14-1 19.97-3.13 39.61-12.3 78.32-21.32 89.99-85.64 156.07-34.19 35.11-77.21 60.73a1.3 1.3-90 0 1-1.32 0q-42.98-25.67-77.32-60.62-30.65-31.19-51.8-69.46Q97.28 294.46 86.25 245q-9.02-40.44-11.48-80.26-.52-8.39-.53-19.99-.02-23.34.07-46.68a.53.51 88.9 0 1 .49-.53q47.8-2.39 94.45-13.04 41.26-9.41 81.04-27.05a2.11 2.1 45.2 0 1 1.72.01q1.74.79 3.82 1.68Zm-53.14 256.67q19.99 18.66 48.13 35.43a.83.83 90 0 0 .86 0q21.29-12.65 40.29-28.42 9.61-7.98 14.13-14.06 11.65-15.69 11.65-35.76v-90.98a.52.52 90 0 0-.52-.52l-132.42.06a.5.49 0 0 0-.5.49q.32 45.48.38 90.95.03 26.05 18 42.81Z"></path><path fill="#fff" d="M202.69 315.81q-17.97-16.76-18-42.81-.06-45.47-.38-90.95a.5.49 0 0 1 .5-.49l132.42-.06a.52.52-90 0 1 .52.52V273q0 20.07-11.65 35.76-4.52 6.08-14.13 14.06-19 15.77-40.29 28.42a.83.83-90 0 1-.86 0q-28.14-16.77-48.13-35.43Zm-7.63-128.29q-1.81-.09-4.01.03a.59.58 88.5 0 0-.55.59v71.12q0 16.12.49 19.97 2.71 21.36 19.85 35.93 18.84 16.01 39.98 28.83a.83.83 90 0 0 .86 0q19.76-11.9 38.88-27.93 20.76-17.39 20.83-44.56.11-41.38.11-83.55a.45.45 45 0 0-.45-.45q-55.89-.11-111.98.18-.5 0-4.01-.16Z"></path><path fill="#274654" d="M199.07 187.68q56.09-.29 111.98-.18a.45.45 45 0 1 .45.45q0 42.17-.11 83.55-.07 27.17-20.83 44.56-19.12 16.03-38.88 27.93a.83.83-90 0 1-.86 0q-21.14-12.82-39.98-28.83-17.14-14.57-19.85-35.93-.49-3.85-.49-19.97v-71.12a.59.58 88.5 0 1 .55-.59q2.2-.12 4.01-.03 3.51.16 4.01.16Zm51.58 70.72-41.2-40.58q-.68-.67-.69.29l-.26 27.64a1.18 1.16-67.2 0 0 .34.85l41.72 41.83a.63.62-44.7 0 0 .89 0l41.45-41.58a1.28 1.17 69.8 0 0 .35-.85l.19-27.82q.01-1.24-.87-.38l-41.21 40.6a.51.5-44.6 0 1-.71 0Z"></path><path fill="#fff" d="m251.36 258.4 41.21-40.6q.88-.86.87.38l-.19 27.82a1.28 1.17 69.8 0 1-.35.85l-41.45 41.58a.63.62-44.7 0 1-.89 0l-41.72-41.83a1.18 1.16-67.2 0 1-.34-.85l.26-27.64q.01-.96.69-.29l41.2 40.58a.51.5-44.6 0 0 .71 0Z"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Supa Safe</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2025-11-22T00:00:00.000Z">Saturday, November 22, 2025</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Stop Hand-Crafting Tokens</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="/static/images/avatar.jpg" width="38px" height="38px" alt="avatar" class="h-10 w-10 rounded-full"/><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Ted</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/supasaf" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">@supasaf</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><p>It’s 2007. I was a young, bright-eyed developer entering the workforce. This was the era of the &quot;Monolith&quot;—giant, heavy software blocks that ruled the earth. We didn’t have fancy &quot;Microservices.&quot;</p><p>I remember writing C++ code back then. If I needed to call an API from another department, it was like the Wild West. I was manually stitching together HTTP packet headers, byte by byte. Authentication? What authentication? If the network cable was plugged in, we trusted you. &quot;Hey, I’m a packet from the Accounting server!&quot; &quot;Sounds legit, come on in!&quot;</p><p>Fast forward to today. In my local market, surprisingly, not much has changed. Many companies still run their internal services like it’s 2007—completely naked, with zero internal authentication.</p><p>Recently, I had to provide an API for another team’s system to call. My immediate thought was: &quot;<strong>We are doing this right. We are using OAuth 2.0 Client Credentials.</strong>&quot;</p><p>To celebrate this small victory for security (and to make sure I actually understand how it works), I wrote this post to document my journey.</p><h2 id="why-we-need-to-drop-the-artisanal-hand-crafted-tokens"><a href="#why-we-need-to-drop-the-artisanal-hand-crafted-tokens" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Why We Need to Drop the &quot;Artisanal, Hand-Crafted&quot; Tokens</h2><p>In many &quot;good enough&quot; architectures, downstream services use a very lazy authentication method: generating a static Token (like a UUID) and hard-coding it into the config file.</p><p>I call this the &quot;Hand-Crafted Token.&quot; It’s simple, sure. But it’s a security nightmare waiting to happen. Here is why OAuth 2.0 is the adult in the room:</p><ol><li><strong>Lifecycle Management (Rotation &amp; Expiration)</strong></li></ol><ul><li><p><strong>Hand-Crafted</strong>: Usually valid forever. If it leaks, you have to change the code, update the config, and restart the servers on both sides. It’s painful.</p></li><li><p><strong>OAuth 2.0</strong>: Access Tokens are short-lived (e.g., 24 hours). If a hacker steals one, they only have a tiny window of time to use it.</p></li></ul><ol start="2"><li><strong>Permissions (Scopes)</strong></li></ol><ul><li><p><strong>Hand-Crafted</strong>: Usually represents &quot;God Mode.&quot; If you have the token, you can do anything.</p></li><li><p><strong>OAuth 2.0</strong>: Supports Scopes (like <code>read:data</code> vs <code>write:order</code>). We can restrict a Python script to only read data, following <strong>the Principle of Least Privilege</strong>.</p></li></ul><ol start="3"><li><strong>Standardization &amp; Performance</strong></li></ol><p>We use <strong>JWT (JSON Web Token)</strong> based on asymmetric encryption (RS256). The Go service doesn&#x27;t need to call Auth0 every single time to ask, &quot;Hey, is this token real?&quot; It just downloads a Public Key once and uses math to verify the token locally. This saves network traffic and makes things fast.</p><h2 id="the-flow"><a href="#the-flow" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>The Flow</h2><ol><li>Python CLI (Client) sends <code>Client ID</code> and <code>Client Secret</code> to Auth0.</li><li>Auth0 checks the ID card, and returns a signed <strong>JWT Access Token</strong>.</li><li>Python CLI puts that token in the Header (<code>Authorization: Bearer &lt;token&gt;</code>) and calls the Go Server.</li><li>Go Server (Resource Server) grabs the <strong>Public Key (JWKS)</strong> from Auth0, checks the signature, the expiration, and the Scopes.</li><li>Success: Data is returned.</li></ol><img width="600" src="/static/images/general/client_credentials.jpg"/><h2 id="part-1-auth0-configuration-control-plane"><a href="#part-1-auth0-configuration-control-plane" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Part 1: Auth0 Configuration (Control Plane)</h2><p>This is the control center. Log in to your Auth0 Dashboard and follow along.</p><h3 id="1-create-the-api-resource-server"><a href="#1-create-the-api-resource-server" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>1. Create the API (Resource Server)</h3><p>Go to Applications -&gt; APIs -&gt; Create API.</p><ul><li>Name: <code>Supa API</code></li><li>Identifier: <code>http://localhost:8080</code> Note: This is super important. In OAuth land, this is called the audience. Even though it looks like a URL, it’s just a logical ID. It does not need to be reachable on the public internet.</li><li>Signing Algorithm: Choose <code>RS256</code>.</li></ul><img width="600" src="/static/images/general/occ_1.png"/><h3 id="2-define-scopes"><a href="#2-define-scopes" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>2. Define Scopes</h3><p>In the API you just made, click the <strong>Permissions</strong> tab.</p><p>Let&#x27;s add a permission:</p><ul><li><strong>Permission (Scope)</strong>: <code>read:data</code> (Our Go code will specifically look for this string).</li><li><strong>Description</strong>: testing read data</li></ul><p>Click <strong>Add</strong>.</p><img width="600" src="/static/images/general/occ_2.png"/><h3 id="3-create-the-m2m-application-client"><a href="#3-create-the-m2m-application-client" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>3. Create the M2M Application (Client)</h3><p>Go to <strong>Applications</strong> -&gt; <strong>Applications</strong> -&gt; <strong>Create Application</strong>.</p><ul><li>Name: <code>Supa CLI</code>.</li><li>Application Type: <code>Machine to Machine Applications</code>.</li></ul><p>Click <strong>Create</strong>.</p><h3 id="4-authorize"><a href="#4-authorize" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>4. Authorize</h3><p>After creating the app, Auth0 will ask: &quot;Which API does this application talk to?&quot;</p><p>Select the Supa API we created in Step 1.</p><p>Crucial Step: Expand the menu and you will see the read:data scope. <strong>You must check this box</strong>, then click &quot;Authorize&quot;.</p><p>The Logic: This tells Auth0 that this specific machine (App) is allowed to ask for &quot;read&quot; permissions.</p><h3 id="5-get-the-credentials"><a href="#5-get-the-credentials" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>5. Get the Credentials</h3><p>Go to the <strong>Settings</strong> tab of your Supa CLI application.</p><p>Copy the <strong>Domain</strong>, <strong>Client ID</strong>, and <strong>Client Secret</strong>. We need these for our Python script.</p><img width="600" src="/static/images/general/occ_3.png"/><h2 id="part-2-the-downstream-service-go--gin"><a href="#part-2-the-downstream-service-go--gin" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Part 2: The Downstream Service (Go + Gin)</h2><p>Here is our Go service. Notice that it does not save the Client Secret. It doesn&#x27;t know the password. It only cares about the Public Key (JWKS) to verify signatures.</p><div class="relative"><pre><code class="code-highlight language-go"><span class="code-line"><span class="token keyword">package</span> main
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</span><span class="code-line">	<span class="token string">&quot;context&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;fmt&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;log&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;net/url&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;strings&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;time&quot;</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token string">&quot;github.com/auth0/go-jwt-middleware/v2/jwks&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;github.com/auth0/go-jwt-middleware/v2/validator&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;github.com/gin-gonic/gin&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Configuration (Fill in your Auth0 info)</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token punctuation">(</span>
</span><span class="code-line">	Auth0Domain   <span class="token operator">=</span> <span class="token string">&quot;dev-724gim41fcgi3z2p.us.auth0.com&quot;</span> <span class="token comment">// Replace with your Domain</span>
</span><span class="code-line">	Auth0Audience <span class="token operator">=</span> <span class="token string">&quot;http://localhost:8080&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// ensureValidToken is a middleware used to validate the Token</span>
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">ensureValidToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token comment">// 1. Set up JWKS provider (Fetch public keys from Auth0 to verify signatures)</span>
</span><span class="code-line">	issuerURL<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> url<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token string">&quot;https://&quot;</span> <span class="token operator">+</span> Auth0Domain <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">	provider <span class="token operator">:=</span> jwks<span class="token punctuation">.</span><span class="token function">NewCachingProvider</span><span class="token punctuation">(</span>issuerURL<span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">*</span>time<span class="token punctuation">.</span>Minute<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// 2. Set up the validator</span>
</span><span class="code-line">	jwtValidator<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> validator<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>
</span><span class="code-line">		provider<span class="token punctuation">.</span>KeyFunc<span class="token punctuation">,</span>
</span><span class="code-line">		validator<span class="token punctuation">.</span>RS256<span class="token punctuation">,</span>
</span><span class="code-line">		issuerURL<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>Auth0Audience<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Validate that Audience matches</span>
</span><span class="code-line">		validator<span class="token punctuation">.</span><span class="token function">WithCustomClaims</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> validator<span class="token punctuation">.</span>CustomClaims <span class="token punctuation">{</span>
</span><span class="code-line">			<span class="token keyword">return</span> <span class="token operator">&amp;</span>CustomClaims<span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		validator<span class="token punctuation">.</span><span class="token function">WithAllowedClockSkew</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Minute<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		authHeader <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">GetHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token keyword">if</span> authHeader <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">			c<span class="token punctuation">.</span><span class="token function">AbortWithStatusJSON</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;No Authorization header&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">			<span class="token keyword">return</span>
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token comment">// Remove &quot;Bearer &quot; prefix</span>
</span><span class="code-line">		tokenString <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">TrimPrefix</span><span class="token punctuation">(</span>authHeader<span class="token punctuation">,</span> <span class="token string">&quot;Bearer &quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token comment">// 3. Validate Token</span>
</span><span class="code-line">		claims<span class="token punctuation">,</span> err <span class="token operator">:=</span> jwtValidator<span class="token punctuation">.</span><span class="token function">ValidateToken</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tokenString<span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">			log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Token validation failed: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">			c<span class="token punctuation">.</span><span class="token function">AbortWithStatusJSON</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Invalid Token&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">			<span class="token keyword">return</span>
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token comment">// 4. Validate Scope (Optional, but important in OAuth2)</span>
</span><span class="code-line">		<span class="token comment">// Here we demonstrate a simple check; production environments may use more complex logic</span>
</span><span class="code-line">		customClaims <span class="token operator">:=</span> claims<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>validator<span class="token punctuation">.</span>ValidatedClaims<span class="token punctuation">)</span><span class="token punctuation">.</span>CustomClaims<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>CustomClaims<span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token keyword">if</span> <span class="token operator">!</span>strings<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>customClaims<span class="token punctuation">.</span>Scope<span class="token punctuation">,</span> <span class="token string">&quot;read:data&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">			c<span class="token punctuation">.</span><span class="token function">AbortWithStatusJSON</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Insufficient scope&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">			<span class="token keyword">return</span>
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">		c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// CustomClaims is used to parse custom fields in the Token (e.g., Scope)</span>
</span><span class="code-line"><span class="token keyword">type</span> CustomClaims <span class="token keyword">struct</span> <span class="token punctuation">{</span>
</span><span class="code-line">	Scope <span class="token builtin">string</span> <span class="token string">`json:&quot;scope&quot;`</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>CustomClaims<span class="token punctuation">)</span> <span class="token function">Validate</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// Public endpoint (No authentication required)</span>
</span><span class="code-line">	r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/ping&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;pong&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// Protected endpoint (Requires OAuth2 authentication)</span>
</span><span class="code-line">	protected <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">&quot;/api&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">	protected<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span><span class="token function">ensureValidToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">{</span>
</span><span class="code-line">		protected<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/data&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">			c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span>
</span><span class="code-line">				<span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Congras! Authentication success!&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">				<span class="token string">&quot;data&quot;</span><span class="token punctuation">:</span>    <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;Secret A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Secret B&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">			<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Server running on http://localhost:8080&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">	r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">&quot;:8080&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h2 id="part-3-the-upstream-client-python"><a href="#part-3-the-upstream-client-python" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Part 3: The Upstream Client (Python)</h2><p>The Python script acts as the upstream microservice. Its job is to trade the Client Credentials for a Token, and then use that Token to knock on Go&#x27;s door.</p><div class="relative"><pre><code class="code-highlight language-python"><span class="code-line"><span class="token keyword">import</span> requests
</span><span class="code-line"><span class="token keyword">import</span> sys
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Configuration (Copy from Auth0 Application Settings)</span>
</span><span class="code-line">AUTH0_DOMAIN <span class="token operator">=</span> <span class="token string">&quot;dev-724gim41fcgi3z2p.us.auth0.com&quot;</span>
</span><span class="code-line">CLIENT_ID <span class="token operator">=</span> <span class="token string">&quot;zJlvk0TKsOKxTO8w...&quot;</span>
</span><span class="code-line">CLIENT_SECRET <span class="token operator">=</span> <span class="token string">&quot;i1v5lGTJOVFc...&quot;</span>
</span><span class="code-line">AUDIENCE <span class="token operator">=</span> <span class="token string">&quot;http://localhost:8080&quot;</span> <span class="token comment"># Must match the one in Go Server</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">get_access_token</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token string triple-quoted-string">&quot;&quot;&quot;
</span></span><span class="code-line"><span class="token string triple-quoted-string">    Step 1: Request Token from Auth0
</span></span><span class="code-line"><span class="token string triple-quoted-string">    &quot;&quot;&quot;</span>
</span><span class="code-line">    url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;https://</span><span class="token interpolation"><span class="token punctuation">{</span>AUTH0_DOMAIN<span class="token punctuation">}</span></span><span class="token string">/oauth/token&quot;</span></span>
</span><span class="code-line">    
</span><span class="code-line">    payload <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token string">&quot;client_id&quot;</span><span class="token punctuation">:</span> CLIENT_ID<span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token string">&quot;client_secret&quot;</span><span class="token punctuation">:</span> CLIENT_SECRET<span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token string">&quot;audience&quot;</span><span class="token punctuation">:</span> AUDIENCE<span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token string">&quot;grant_type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;client_credentials&quot;</span> 
</span><span class="code-line">        <span class="token comment"># Scope is optional here. If omitted, Auth0 grants all allowed scopes for this Client.</span>
</span><span class="code-line">        <span class="token comment"># You can also specify: &quot;scope&quot;: &quot;read:data&quot;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    
</span><span class="code-line">    headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#x27;content-type&#x27;</span><span class="token punctuation">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">}</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Requesting Token from </span><span class="token interpolation"><span class="token punctuation">{</span>url<span class="token punctuation">}</span></span><span class="token string">...&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> json<span class="token operator">=</span>payload<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">!=</span> <span class="token number">200</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Failed to retrieve Token: </span><span class="token interpolation"><span class="token punctuation">{</span>response<span class="token punctuation">.</span>text<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">        
</span><span class="code-line">    data <span class="token operator">=</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Token retrieved successfully!&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> data<span class="token punctuation">[</span><span class="token string">&#x27;access_token&#x27;</span><span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">call_api</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token string triple-quoted-string">&quot;&quot;&quot;
</span></span><span class="code-line"><span class="token string triple-quoted-string">    Step 2: Access local Go Server with Token
</span></span><span class="code-line"><span class="token string triple-quoted-string">    &quot;&quot;&quot;</span>
</span><span class="code-line">    api_url <span class="token operator">=</span> <span class="token string">&quot;http://localhost:8080/api/data&quot;</span>
</span><span class="code-line">    
</span><span class="code-line">    headers <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f&quot;Bearer </span><span class="token interpolation"><span class="token punctuation">{</span>token<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\nCalling API: </span><span class="token interpolation"><span class="token punctuation">{</span>api_url<span class="token punctuation">}</span></span><span class="token string"> ...&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>api_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\n=== Call successful! ===&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Server response:&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\n=== Call failed [</span><span class="token interpolation"><span class="token punctuation">{</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">}</span></span><span class="token string">] ===&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Server response:&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token comment"># 1. Get Token</span>
</span><span class="code-line">    token <span class="token operator">=</span> get_access_token<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token comment"># 2. (Optional) Print Token to see what it looks like</span>
</span><span class="code-line">    <span class="token comment"># You can paste this token into jwt.io to decode and view contents</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Access Token:&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">)</span>    
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 3. Call Interface</span>
</span><span class="code-line">    call_api<span class="token punctuation">(</span>token<span class="token punctuation">)</span>
</span></code></pre></div><h2 id="part-4-jwks--the-magic-of-rotation"><a href="#part-4-jwks--the-magic-of-rotation" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Part 4: JWKS &amp; The Magic of Rotation</h2><p>You might be wondering: &quot;<strong>Wait, the Go server doesn&#x27;t have the password. How does it know the Token isn&#x27;t fake?</strong>&quot;</p><p>This is where <strong>JWKS (JSON Web Key Set)</strong> comes in to save the day.</p><h3 id="1-what-is-jwks"><a href="#1-what-is-jwks" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>1. What is JWKS?</h3><p>JWKS isn&#x27;t a file you download manually. It&#x27;s a public endpoint hosted by Auth0. When our Go program starts, it quietly visits a URL like this in the background:</p><div class="relative"><pre><code class="code-highlight"><span class="code-line">https://dev-724gim41fcgi3z2p.us.auth0.com/.well-known/jwks.json
</span></code></pre></div><p>And it downloads a list of public keys that looks like this:</p><div class="relative"><pre><code class="code-highlight language-json"><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">&quot;keys&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-line">    <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property">&quot;kty&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RSA&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;use&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sig&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;n&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4CemFJ7TlHiramjrCuL-RU=..bala&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;e&quot;</span><span class="token operator">:</span> <span class="token string">&quot;AQAB&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;kid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zNzOehS3IyrE_affVCCbV&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;x5t&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Y22Fn3PK4_hPu_DbjbaBdwquCh8&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;x5c&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-line">        <span class="token string">&quot;MIIDHTCCAgW...wwHVUEUpmL...bala&quot;</span>
</span><span class="code-line">      <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;alg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RS256&quot;</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property">&quot;kty&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RSA&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;use&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sig&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;n&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lM3Xs6f4kW...bala&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;e&quot;</span><span class="token operator">:</span> <span class="token string">&quot;AQAB&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;kid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;GhlB5qAXm3pI1C8dXhag1&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;x5t&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t7RmMk_OungUDOxDjxVgFBuNSg0&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;x5c&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-line">        <span class="token string">&quot;MIIDHTCCAgWgAw...RjUlHTLoPmucCC...bala&quot;</span>
</span><span class="code-line">      <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;alg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RS256&quot;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">]</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>The Logic:</p><ol><li>The Token from Python has a kid (Key ID) in its Header.</li></ol><img width="500" src="/static/images/general/occ_4.png"/><ol start="2"><li>Go looks at that <code>kid</code>, finds the matching <strong>Public Key</strong> in the list above.</li><li>Go uses the <code>n</code> and <code>e</code> values to mathematically verify the signature.</li></ol><h3 id="2-caching-dont-kill-the-server"><a href="#2-caching-dont-kill-the-server" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>2. Caching (Don&#x27;t kill the server)</h3><p>&quot;<strong>If Go downloads this JSON on every request, won&#x27;t Auth0 explode?</strong>&quot;</p><p>Good question. That&#x27;s why we have this line in the Go code:</p><div class="relative"><pre><code class="code-highlight language-go"><span class="code-line">provider <span class="token operator">:=</span> jwks<span class="token punctuation">.</span><span class="token function">NewCachingProvider</span><span class="token punctuation">(</span>issuerURL<span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">*</span>time<span class="token punctuation">.</span>Minute<span class="token punctuation">)</span>
</span></code></pre></div><ul><li>First Request: Download the keys, store in RAM.</li><li>Next 5 Minutes: Use RAM. This is microsecond-level fast.</li><li>After 5 Minutes: Cache expires. Download again.</li></ul><h3 id="3-the-killer-feature-key-rotation-zero-downtime"><a href="#3-the-killer-feature-key-rotation-zero-downtime" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>3. The Killer Feature: Key Rotation (Zero Downtime)</h3><p>This is why JWKS beats &quot;Hand-Crafted Tokens.&quot;</p><p>If we need to rotate the keys (maybe for compliance, or maybe because someone pasted the private key on StackOverflow):</p><ol><li>Auth0 generates a New pair of keys.</li><li>Auth0 puts the New Public Key in the jwks.json list, but keeps the Old Public Key there too.</li><li>Auth0 starts signing new tokens with the New Private Key.</li><li>The Go service downloads the updated list (within 5 mins).</li><li>Because the list has both keys, Go can verify both old tokens (valid until they expire) and new tokens.</li></ol><p>So, we just changed the entire security foundation without changing a single line of code or restarting a single server.</p><h3 id="4-seeing-it-in-action"><a href="#4-seeing-it-in-action" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>4. Seeing it in action</h3><p>I triggered a rotation in Auth0:</p><img width="600" src="/static/images/general/occ_5.png"/><p>I ran the client again without changing code:</p><div class="relative"><pre><code class="code-highlight language-shell"><span class="code-line"><span class="token punctuation">(</span>base<span class="token punctuation">)</span> ss@ss:~/client_credential1120$ python3 supa_cli.py
</span><span class="code-line">Requesting Token from https://dev-724gim41fcgi3z2p.us.auth0.com/oauth/token<span class="token punctuation">..</span>.
</span><span class="code-line">Token retrieved successfully<span class="token operator">!</span>
</span><span class="code-line">------------------------------------------------------------
</span><span class="code-line">Access Token:
</span><span class="code-line">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImt<span class="token punctuation">..</span>.blabla
</span><span class="code-line">------------------------------------------------------------
</span><span class="code-line">
</span><span class="code-line">Calling API: http://localhost:8080/api/data <span class="token punctuation">..</span>.
</span><span class="code-line">
</span><span class="code-line"><span class="token operator">==</span><span class="token operator">=</span> Call successful<span class="token operator">!</span> <span class="token operator">==</span><span class="token operator">=</span>
</span><span class="code-line">Server response: <span class="token punctuation">{</span><span class="token string">&#x27;data&#x27;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&#x27;Secret A&#x27;</span>, <span class="token string">&#x27;Secret B&#x27;</span><span class="token punctuation">]</span>, <span class="token string">&#x27;message&#x27;</span><span class="token builtin class-name">:</span> <span class="token string">&#x27;Congras! Authentication success!&#x27;</span><span class="token punctuation">}</span>
</span></code></pre></div><p>Look closely, the kid has changed automatically:</p><img width="600" src="/static/images/general/occ_6.png"/><p>And verified in the backend:</p><img width="300" src="/static/images/general/occ_7.png"/><h2 id="running-result"><a href="#running-result" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Running Result</h2><img width="600" src="/static/images/general/occ_8.png"/><h2 id="appendix-doing-the-math-for-the-curious"><a href="#appendix-doing-the-math-for-the-curious" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Appendix: Doing the Math (For the curious)</h2><p>I mentioned that we use <code>n</code> (Modulus) and <code>e</code> (Exponent) to restore the RSA Public Key and verify the signature. If you don&#x27;t trust the library and want to see the math yourself, here is a Python script I wrote to manually verify the JWT.</p><div class="relative"><pre><code class="code-highlight language-python"><span class="code-line"><span class="token keyword">import</span> base64
</span><span class="code-line"><span class="token keyword">import</span> json
</span><span class="code-line"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> rsa
</span><span class="code-line"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> serialization
</span><span class="code-line"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> hashes
</span><span class="code-line"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> padding
</span><span class="code-line"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># ================= Configuration Area =================</span>
</span><span class="code-line"><span class="token comment"># 1. Paste your full Token here</span>
</span><span class="code-line">TOKEN <span class="token operator">=</span> <span class="token string">&quot;eyJhbGciO...&quot;</span> 
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># 2. Paste the corresponding n and e values found in jwks.json</span>
</span><span class="code-line"><span class="token comment"># Note: Must match the key pair corresponding to the kid in the Token Header</span>
</span><span class="code-line">N_VALUE <span class="token operator">=</span> <span class="token string">&quot;4CemFJ7TlHiram...&quot;</span> <span class="token comment"># This is a very long string</span>
</span><span class="code-line">E_VALUE <span class="token operator">=</span> <span class="token string">&quot;AQAB&quot;</span>      <span class="token comment"># Usually very short</span>
</span><span class="code-line"><span class="token comment"># ======================================================</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">base64_to_int</span><span class="token punctuation">(</span>data_str<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token string triple-quoted-string">&quot;&quot;&quot;
</span></span><span class="code-line"><span class="token string triple-quoted-string">    Helper function: Convert Base64URL string to Integer (Big Integer)
</span></span><span class="code-line"><span class="token string triple-quoted-string">    Principle: Base64 -&gt; Bytes -&gt; Integer
</span></span><span class="code-line"><span class="token string triple-quoted-string">    &quot;&quot;&quot;</span>
</span><span class="code-line">    <span class="token comment"># 1. Add Base64 padding (&#x27;=&#x27;) to avoid decoding errors</span>
</span><span class="code-line">    padding_len <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_str<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">if</span> padding_len <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">:</span>
</span><span class="code-line">        data_str <span class="token operator">+=</span> <span class="token string">&quot;=&quot;</span> <span class="token operator">*</span> padding_len
</span><span class="code-line">    
</span><span class="code-line">    <span class="token comment"># 2. Base64URL decode to bytes</span>
</span><span class="code-line">    decoded_bytes <span class="token operator">=</span> base64<span class="token punctuation">.</span>urlsafe_b64decode<span class="token punctuation">(</span>data_str<span class="token punctuation">)</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token comment"># 3. Convert bytes to Big Integer (Big Endian)</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>decoded_bytes<span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">&#x27;big&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">manual_verify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;--- Starting manual public key construction and verification ---&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># Step 1: Reconstruct RSA Public Key Object</span>
</span><span class="code-line">    <span class="token comment"># This is a purely mathematical process: Public Key = (n, e)</span>
</span><span class="code-line">    <span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line">        n_int <span class="token operator">=</span> base64_to_int<span class="token punctuation">(</span>N_VALUE<span class="token punctuation">)</span>
</span><span class="code-line">        e_int <span class="token operator">=</span> base64_to_int<span class="token punctuation">(</span>E_VALUE<span class="token punctuation">)</span>
</span><span class="code-line">        
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[1] Conversion successful:&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;    n (First 50 digits): </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">str</span><span class="token punctuation">(</span>n_int<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">50]</span><span class="token punctuation">}</span></span><span class="token string">...&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;    e (Integer): </span><span class="token interpolation"><span class="token punctuation">{</span>e_int<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token comment"># Use the cryptography library to assemble n and e into a public key object</span>
</span><span class="code-line">        public_numbers <span class="token operator">=</span> rsa<span class="token punctuation">.</span>RSAPublicNumbers<span class="token punctuation">(</span>e_int<span class="token punctuation">,</span> n_int<span class="token punctuation">)</span>
</span><span class="code-line">        public_key <span class="token operator">=</span> public_numbers<span class="token punctuation">.</span>public_key<span class="token punctuation">(</span>default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[2] RSA Public Key object constructed successfully!&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">        
</span><span class="code-line">    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Public key reconstruction failed: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># Step 2: Disassemble Token</span>
</span><span class="code-line">    <span class="token comment"># JWT Format: Header.Payload.Signature</span>
</span><span class="code-line">    parts <span class="token operator">=</span> TOKEN<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#x27;.&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>parts<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Invalid Token format&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># The signature is also Base64URL encoded and needs to be decoded into raw bytes</span>
</span><span class="code-line">    header_payload <span class="token operator">=</span> parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&#x27;.&#x27;</span> <span class="token operator">+</span> parts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># This is the original content that was signed (Message)</span>
</span><span class="code-line">    signature_b64 <span class="token operator">=</span> parts<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token comment"># Add padding and decode signature</span>
</span><span class="code-line">    sig_padding <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>signature_b64<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">if</span> sig_padding <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">:</span>
</span><span class="code-line">        signature_b64 <span class="token operator">+=</span> <span class="token string">&quot;=&quot;</span> <span class="token operator">*</span> sig_padding
</span><span class="code-line">    signature_bytes <span class="token operator">=</span> base64<span class="token punctuation">.</span>urlsafe_b64decode<span class="token punctuation">(</span>signature_b64<span class="token punctuation">)</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[3] Token disassembled successfully. Data length to verify: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>header_payload<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> bytes&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># Step 3: Perform Mathematical Signature Verification</span>
</span><span class="code-line">    <span class="token comment"># Algorithm: RS256 (RSA Signature + SHA256 Hash)</span>
</span><span class="code-line">    <span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line">        public_key<span class="token punctuation">.</span>verify<span class="token punctuation">(</span>
</span><span class="code-line">            signature_bytes<span class="token punctuation">,</span>                        <span class="token comment"># The real signature (Encrypted Hash)</span>
</span><span class="code-line">            header_payload<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&#x27;ascii&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>         <span class="token comment"># Original content (We calculate the Hash ourselves)</span>
</span><span class="code-line">            padding<span class="token punctuation">.</span>PKCS1v15<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                     <span class="token comment"># JWT standard uses PKCS1 v1.5 padding</span>
</span><span class="code-line">            hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span>                         <span class="token comment"># JWT standard uses SHA256</span>
</span><span class="code-line">        <span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\n✅ Verification Passed! (Signature Valid)&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Conclusion: This Token was indeed signed by the entity holding the private key (Auth0) and has not been tampered with.&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\n❌ Verification Failed! (Signature Invalid)&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Error details: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Possible reasons:&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;1. Incorrect n or e copied (must match kid)&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;2. Incomplete Token copied&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;3. Token content has been modified&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    manual_verify<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><p>The Result:</p><img width="600" src="/static/images/general/occ_9.png"/></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/architect">Architect</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/terraform/terraform_sec_6_presigned">Stop Making Your S3 Buckets Public! A Guide to Presigned URLs</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Supa Safe</div><div> • </div><div>© 2025</div><div> • </div><a href="/">Cybersecurity, Cloud and Compiler</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var d=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var i=a=\u003el(a,\"__esModule\",{value:!0});var N=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=\u003e{i(a);for(var t in s)l(a,t,{get:s[t],enumerable:!0})},g=(a,s,t)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let e of h(s))!u.call(a,e)\u0026\u0026e!==\"default\"\u0026\u0026l(a,e,{get:()=\u003es[e],enumerable:!(t=p(s,e))||t.enumerable});return a},y=a=\u003eg(i(l(a!=null?d(m(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=N((C,o)=\u003e{o.exports=_jsx_runtime});var A={};k(A,{default:()=\u003eb,frontmatter:()=\u003ef});var n=y(r()),f={title:\"Stop Hand-Crafting Tokens\",date:\"2025-11-22\",tags:[\"Architect\"],draft:!1,summary:\"Stop using hard-coded tokens like it's 2007: A deep dive into securing microservices with OAuth 2.0 Client Credentials and the magic of JWKS key rotation.\",images:[]};function w(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(t,{})})):t();function t(){let e=Object.assign({p:\"p\",strong:\"strong\",h2:\"h2\",a:\"a\",span:\"span\",ol:\"ol\",li:\"li\",ul:\"ul\",code:\"code\",h3:\"h3\",pre:\"pre\"},a.components),{Image:c}=e;return c||v(\"Image\",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:'It\\u2019s 2007. I was a young, bright-eyed developer entering the workforce. This was the era of the \"Monolith\"\\u2014giant, heavy software blocks that ruled the earth. We didn\\u2019t have fancy \"Microservices.\"'}),(0,n.jsx)(e.p,{children:'I remember writing C++ code back then. If I needed to call an API from another department, it was like the Wild West. I was manually stitching together HTTP packet headers, byte by byte. Authentication? What authentication? If the network cable was plugged in, we trusted you. \"Hey, I\\u2019m a packet from the Accounting server!\" \"Sounds legit, come on in!\"'}),(0,n.jsx)(e.p,{children:\"Fast forward to today. In my local market, surprisingly, not much has changed. Many companies still run their internal services like it\\u2019s 2007\\u2014completely naked, with zero internal authentication.\"}),(0,n.jsxs)(e.p,{children:['Recently, I had to provide an API for another team\\u2019s system to call. My immediate thought was: \"',(0,n.jsx)(e.strong,{children:\"We are doing this right. We are using OAuth 2.0 Client Credentials.\"}),'\"']}),(0,n.jsx)(e.p,{children:\"To celebrate this small victory for security (and to make sure I actually understand how it works), I wrote this post to document my journey.\"}),(0,n.jsxs)(e.h2,{id:\"why-we-need-to-drop-the-artisanal-hand-crafted-tokens\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#why-we-need-to-drop-the-artisanal-hand-crafted-tokens\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),'Why We Need to Drop the \"Artisanal, Hand-Crafted\" Tokens']}),(0,n.jsx)(e.p,{children:'In many \"good enough\" architectures, downstream services use a very lazy authentication method: generating a static Token (like a UUID) and hard-coding it into the config file.'}),(0,n.jsx)(e.p,{children:'I call this the \"Hand-Crafted Token.\" It\\u2019s simple, sure. But it\\u2019s a security nightmare waiting to happen. Here is why OAuth 2.0 is the adult in the room:'}),(0,n.jsx)(e.ol,{children:(0,n.jsx)(e.li,{children:(0,n.jsx)(e.strong,{children:\"Lifecycle Management (Rotation \u0026 Expiration)\"})})}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Hand-Crafted\"}),\": Usually valid forever. If it leaks, you have to change the code, update the config, and restart the servers on both sides. It\\u2019s painful.\"]})}),(0,n.jsx)(e.li,{children:(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"OAuth 2.0\"}),\": Access Tokens are short-lived (e.g., 24 hours). If a hacker steals one, they only have a tiny window of time to use it.\"]})})]}),(0,n.jsx)(e.ol,{start:\"2\",children:(0,n.jsx)(e.li,{children:(0,n.jsx)(e.strong,{children:\"Permissions (Scopes)\"})})}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Hand-Crafted\"}),': Usually represents \"God Mode.\" If you have the token, you can do anything.']})}),(0,n.jsx)(e.li,{children:(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"OAuth 2.0\"}),\": Supports Scopes (like \",(0,n.jsx)(e.code,{children:\"read:data\"}),\" vs \",(0,n.jsx)(e.code,{children:\"write:order\"}),\"). We can restrict a Python script to only read data, following \",(0,n.jsx)(e.strong,{children:\"the Principle of Least Privilege\"}),\".\"]})})]}),(0,n.jsx)(e.ol,{start:\"3\",children:(0,n.jsx)(e.li,{children:(0,n.jsx)(e.strong,{children:\"Standardization \u0026 Performance\"})})}),(0,n.jsxs)(e.p,{children:[\"We use \",(0,n.jsx)(e.strong,{children:\"JWT (JSON Web Token)\"}),` based on asymmetric encryption (RS256). The Go service doesn't need to call Auth0 every single time to ask, \"Hey, is this token real?\" It just downloads a Public Key once and uses math to verify the token locally. This saves network traffic and makes things fast.`]}),(0,n.jsxs)(e.h2,{id:\"the-flow\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#the-flow\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"The Flow\"]}),(0,n.jsxs)(e.ol,{children:[(0,n.jsxs)(e.li,{children:[\"Python CLI (Client) sends \",(0,n.jsx)(e.code,{children:\"Client ID\"}),\" and \",(0,n.jsx)(e.code,{children:\"Client Secret\"}),\" to Auth0.\"]}),(0,n.jsxs)(e.li,{children:[\"Auth0 checks the ID card, and returns a signed \",(0,n.jsx)(e.strong,{children:\"JWT Access Token\"}),\".\"]}),(0,n.jsxs)(e.li,{children:[\"Python CLI puts that token in the Header (\",(0,n.jsx)(e.code,{children:\"Authorization: Bearer \u003ctoken\u003e\"}),\") and calls the Go Server.\"]}),(0,n.jsxs)(e.li,{children:[\"Go Server (Resource Server) grabs the \",(0,n.jsx)(e.strong,{children:\"Public Key (JWKS)\"}),\" from Auth0, checks the signature, the expiration, and the Scopes.\"]}),(0,n.jsx)(e.li,{children:\"Success: Data is returned.\"})]}),(0,n.jsx)(c,{width:600,src:\"/static/images/general/client_credentials.jpg\"}),(0,n.jsxs)(e.h2,{id:\"part-1-auth0-configuration-control-plane\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#part-1-auth0-configuration-control-plane\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Part 1: Auth0 Configuration (Control Plane)\"]}),(0,n.jsx)(e.p,{children:\"This is the control center. Log in to your Auth0 Dashboard and follow along.\"}),(0,n.jsxs)(e.h3,{id:\"1-create-the-api-resource-server\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#1-create-the-api-resource-server\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"1. Create the API (Resource Server)\"]}),(0,n.jsx)(e.p,{children:\"Go to Applications -\u003e APIs -\u003e Create API.\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsxs)(e.li,{children:[\"Name: \",(0,n.jsx)(e.code,{children:\"Supa API\"})]}),(0,n.jsxs)(e.li,{children:[\"Identifier: \",(0,n.jsx)(e.code,{children:\"http://localhost:8080\"}),\" Note: This is super important. In OAuth land, this is called the audience. Even though it looks like a URL, it\\u2019s just a logical ID. It does not need to be reachable on the public internet.\"]}),(0,n.jsxs)(e.li,{children:[\"Signing Algorithm: Choose \",(0,n.jsx)(e.code,{children:\"RS256\"}),\".\"]})]}),(0,n.jsx)(c,{width:600,src:\"/static/images/general/occ_1.png\"}),(0,n.jsxs)(e.h3,{id:\"2-define-scopes\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#2-define-scopes\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"2. Define Scopes\"]}),(0,n.jsxs)(e.p,{children:[\"In the API you just made, click the \",(0,n.jsx)(e.strong,{children:\"Permissions\"}),\" tab.\"]}),(0,n.jsx)(e.p,{children:\"Let's add a permission:\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Permission (Scope)\"}),\": \",(0,n.jsx)(e.code,{children:\"read:data\"}),\" (Our Go code will specifically look for this string).\"]}),(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Description\"}),\": testing read data\"]})]}),(0,n.jsxs)(e.p,{children:[\"Click \",(0,n.jsx)(e.strong,{children:\"Add\"}),\".\"]}),(0,n.jsx)(c,{width:600,src:\"/static/images/general/occ_2.png\"}),(0,n.jsxs)(e.h3,{id:\"3-create-the-m2m-application-client\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#3-create-the-m2m-application-client\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3. Create the M2M Application (Client)\"]}),(0,n.jsxs)(e.p,{children:[\"Go to \",(0,n.jsx)(e.strong,{children:\"Applications\"}),\" -\u003e \",(0,n.jsx)(e.strong,{children:\"Applications\"}),\" -\u003e \",(0,n.jsx)(e.strong,{children:\"Create Application\"}),\".\"]}),(0,n.jsxs)(e.ul,{children:[(0,n.jsxs)(e.li,{children:[\"Name: \",(0,n.jsx)(e.code,{children:\"Supa CLI\"}),\".\"]}),(0,n.jsxs)(e.li,{children:[\"Application Type: \",(0,n.jsx)(e.code,{children:\"Machine to Machine Applications\"}),\".\"]})]}),(0,n.jsxs)(e.p,{children:[\"Click \",(0,n.jsx)(e.strong,{children:\"Create\"}),\".\"]}),(0,n.jsxs)(e.h3,{id:\"4-authorize\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#4-authorize\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"4. Authorize\"]}),(0,n.jsx)(e.p,{children:'After creating the app, Auth0 will ask: \"Which API does this application talk to?\"'}),(0,n.jsx)(e.p,{children:\"Select the Supa API we created in Step 1.\"}),(0,n.jsxs)(e.p,{children:[\"Crucial Step: Expand the menu and you will see the read:data scope. \",(0,n.jsx)(e.strong,{children:\"You must check this box\"}),', then click \"Authorize\".']}),(0,n.jsx)(e.p,{children:'The Logic: This tells Auth0 that this specific machine (App) is allowed to ask for \"read\" permissions.'}),(0,n.jsxs)(e.h3,{id:\"5-get-the-credentials\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#5-get-the-credentials\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"5. Get the Credentials\"]}),(0,n.jsxs)(e.p,{children:[\"Go to the \",(0,n.jsx)(e.strong,{children:\"Settings\"}),\" tab of your Supa CLI application.\"]}),(0,n.jsxs)(e.p,{children:[\"Copy the \",(0,n.jsx)(e.strong,{children:\"Domain\"}),\", \",(0,n.jsx)(e.strong,{children:\"Client ID\"}),\", and \",(0,n.jsx)(e.strong,{children:\"Client Secret\"}),\". We need these for our Python script.\"]}),(0,n.jsx)(c,{width:600,src:\"/static/images/general/occ_3.png\"}),(0,n.jsxs)(e.h2,{id:\"part-2-the-downstream-service-go--gin\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#part-2-the-downstream-service-go--gin\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Part 2: The Downstream Service (Go + Gin)\"]}),(0,n.jsx)(e.p,{children:\"Here is our Go service. Notice that it does not save the Client Secret. It doesn't know the password. It only cares about the Public Key (JWKS) to verify signatures.\"}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-go\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"package\"}),` main\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"context\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"fmt\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"log\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"net/url\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"strings\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"time\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"github.com/auth0/go-jwt-middleware/v2/jwks\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"github.com/auth0/go-jwt-middleware/v2/validator\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"github.com/gin-gonic/gin\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Configuration (Fill in your Auth0 info)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tAuth0Domain   \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"dev-724gim41fcgi3z2p.us.auth0.com\"'}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Replace with your Domain\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tAuth0Audience \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"http://localhost:8080\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// ensureValidToken is a middleware used to validate the Token\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"ensureValidToken\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" gin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"HandlerFunc \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 1. Set up JWKS provider (Fetch public keys from Auth0 to verify signatures)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tissuerURL\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Parse\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"https://\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" Auth0Domain \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tprovider \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" jwks\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewCachingProvider\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"issuerURL\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"time\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Minute\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 2. Set up the validator\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tjwtValidator\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" validator\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"New\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tprovider\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"KeyFunc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tvalidator\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"RS256\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tissuerURL\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Auth0Audience\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Validate that Audience matches\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tvalidator\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"WithCustomClaims\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" validator\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"CustomClaims \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"CustomClaims\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tvalidator\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"WithAllowedClockSkew\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"time\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Minute\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"c \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"gin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tauthHeader \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"GetHeader\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Authorization\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" authHeader \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"AbortWithStatusJSON\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"401\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" gin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"H\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"error\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"No Authorization header\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// Remove \"Bearer \" prefix'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\ttokenString \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" strings\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"TrimPrefix\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"authHeader\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Bearer \"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 3. Validate Token\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tclaims\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" jwtValidator\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ValidateToken\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Background\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tokenString\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Printf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Token validation failed: %v\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"AbortWithStatusJSON\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"401\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" gin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"H\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"error\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Invalid Token\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 4. Validate Scope (Optional, but important in OAuth2)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Here we demonstrate a simple check; production environments may use more complex logic\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tcustomClaims \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" claims\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"validator\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ValidatedClaims\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"CustomClaims\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"CustomClaims\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),\"strings\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Contains\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"customClaims\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Scope\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"read:data\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"AbortWithStatusJSON\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"403\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" gin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"H\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"error\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Insufficient scope\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Next\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// CustomClaims is used to parse custom fields in the Token (e.g., Scope)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" CustomClaims \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tScope \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'`json:\"scope\"`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"c \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"CustomClaims\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"Validate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"error\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" gin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Default\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Public endpoint (No authentication required)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tr\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"GET\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"/ping\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"c \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"gin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"JSON\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"200\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" gin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"H\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"message\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"pong\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Protected endpoint (Requires OAuth2 authentication)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tprotected \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Group\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"/api\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tprotected\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Use\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ensureValidToken\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tprotected\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"GET\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"/data\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"c \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"gin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"JSON\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"200\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" gin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"H\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"message\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Congras! Authentication success!\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"data\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Secret A\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Secret B\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tfmt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Println\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Server running on http://localhost:8080\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tr\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Run\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\":8080\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.h2,{id:\"part-3-the-upstream-client-python\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#part-3-the-upstream-client-python\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Part 3: The Upstream Client (Python)\"]}),(0,n.jsx)(e.p,{children:\"The Python script acts as the upstream microservice. Its job is to trade the Client Credentials for a Token, and then use that Token to knock on Go's door.\"}),(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-python\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` requests\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` sys\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Configuration (Copy from Auth0 Application Settings)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"AUTH0_DOMAIN \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"dev-724gim41fcgi3z2p.us.auth0.com\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"CLIENT_ID \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"zJlvk0TKsOKxTO8w...\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"CLIENT_SECRET \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"i1v5lGTJOVFc...\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"AUDIENCE \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"http://localhost:8080\"'}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Must match the one in Go Server\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"get_access_token\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token string triple-quoted-string\",children:`\"\"\"\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string triple-quoted-string\",children:`    Step 1: Request Token from Auth0\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string triple-quoted-string\",children:'    \"\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    url \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"https://'}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"AUTH0_DOMAIN\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'/oauth/token\"'})]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    payload \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"client_id\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" CLIENT_ID\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"client_secret\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" CLIENT_SECRET\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"audience\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" AUDIENCE\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"grant_type\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"client_credentials\"'}),` \n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Scope is optional here. If omitted, Auth0 grants all allowed scopes for this Client.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:'# You can also specify: \"scope\": \"read:data\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    headers \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'content-type'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"application/json\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Requesting Token from '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'...\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    response \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" requests\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"post\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" json\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"payload\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" headers\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"headers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" response\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"status_code \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"200\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Failed to retrieve Token: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"response\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"text\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" response\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"json\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Token retrieved successfully!\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'access_token'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"call_api\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token string triple-quoted-string\",children:`\"\"\"\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string triple-quoted-string\",children:`    Step 2: Access local Go Server with Token\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string triple-quoted-string\",children:'    \"\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    api_url \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"http://localhost:8080/api/data\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    headers \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Authorization\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Bearer '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"\\\\nCalling API: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"api_url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:' ...\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    response \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" requests\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"get\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"api_url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" headers\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"headers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" response\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"status_code \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"200\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"\\\\n=== Call successful! ===\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Server response:\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" response\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"json\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"\\\\n=== Call failed ['}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"response\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"status_code\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'] ===\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Server response:\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" response\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"text\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"__main__\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 1. Get Token\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    token \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" get_access_token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 2. (Optional) Print Token to see what it looks like\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# You can paste this token into jwt.io to decode and view contents\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"-\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"60\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Access Token:\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"-\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"60\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`    \n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 3. Call Interface\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    call_api\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,n.jsxs)(e.h2,{id:\"part-4-jwks--the-magic-of-rotation\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#part-4-jwks--the-magic-of-rotation\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Part 4: JWKS \u0026 The Magic of Rotation\"]}),(0,n.jsxs)(e.p,{children:['You might be wondering: \"',(0,n.jsx)(e.strong,{children:\"Wait, the Go server doesn't have the password. How does it know the Token isn't fake?\"}),'\"']}),(0,n.jsxs)(e.p,{children:[\"This is where \",(0,n.jsx)(e.strong,{children:\"JWKS (JSON Web Key Set)\"}),\" comes in to save the day.\"]}),(0,n.jsxs)(e.h3,{id:\"1-what-is-jwks\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#1-what-is-jwks\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"1. What is JWKS?\"]}),(0,n.jsx)(e.p,{children:\"JWKS isn't a file you download manually. It's a public endpoint hosted by Auth0. When our Go program starts, it quietly visits a URL like this in the background:\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`https://dev-724gim41fcgi3z2p.us.auth0.com/.well-known/jwks.json\n`})})}),(0,n.jsx)(e.p,{children:\"And it downloads a list of public keys that looks like this:\"}),(0,n.jsx)(e.pre,{className:\"language-json\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-json\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"keys\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"kty\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"RSA\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"use\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"sig\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"n\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"4CemFJ7TlHiramjrCuL-RU=..bala\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"e\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"AQAB\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"kid\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"zNzOehS3IyrE_affVCCbV\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"x5t\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Y22Fn3PK4_hPu_DbjbaBdwquCh8\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"x5c\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"MIIDHTCCAgW...wwHVUEUpmL...bala\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"alg\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"RS256\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"kty\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"RSA\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"use\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"sig\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"n\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"lM3Xs6f4kW...bala\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"e\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"AQAB\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"kid\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"GhlB5qAXm3pI1C8dXhag1\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"x5t\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"t7RmMk_OungUDOxDjxVgFBuNSg0\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"x5c\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"MIIDHTCCAgWgAw...RjUlHTLoPmucCC...bala\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"alg\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"RS256\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"The Logic:\"}),(0,n.jsx)(e.ol,{children:(0,n.jsx)(e.li,{children:\"The Token from Python has a kid (Key ID) in its Header.\"})}),(0,n.jsx)(c,{width:500,src:\"/static/images/general/occ_4.png\"}),(0,n.jsxs)(e.ol,{start:\"2\",children:[(0,n.jsxs)(e.li,{children:[\"Go looks at that \",(0,n.jsx)(e.code,{children:\"kid\"}),\", finds the matching \",(0,n.jsx)(e.strong,{children:\"Public Key\"}),\" in the list above.\"]}),(0,n.jsxs)(e.li,{children:[\"Go uses the \",(0,n.jsx)(e.code,{children:\"n\"}),\" and \",(0,n.jsx)(e.code,{children:\"e\"}),\" values to mathematically verify the signature.\"]})]}),(0,n.jsxs)(e.h3,{id:\"2-caching-dont-kill-the-server\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#2-caching-dont-kill-the-server\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"2. Caching (Don't kill the server)\"]}),(0,n.jsxs)(e.p,{children:['\"',(0,n.jsx)(e.strong,{children:\"If Go downloads this JSON on every request, won't Auth0 explode?\"}),'\"']}),(0,n.jsx)(e.p,{children:\"Good question. That's why we have this line in the Go code:\"}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-go\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"provider \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" jwks\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewCachingProvider\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"issuerURL\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"time\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Minute\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"First Request: Download the keys, store in RAM.\"}),(0,n.jsx)(e.li,{children:\"Next 5 Minutes: Use RAM. This is microsecond-level fast.\"}),(0,n.jsx)(e.li,{children:\"After 5 Minutes: Cache expires. Download again.\"})]}),(0,n.jsxs)(e.h3,{id:\"3-the-killer-feature-key-rotation-zero-downtime\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#3-the-killer-feature-key-rotation-zero-downtime\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3. The Killer Feature: Key Rotation (Zero Downtime)\"]}),(0,n.jsx)(e.p,{children:'This is why JWKS beats \"Hand-Crafted Tokens.\"'}),(0,n.jsx)(e.p,{children:\"If we need to rotate the keys (maybe for compliance, or maybe because someone pasted the private key on StackOverflow):\"}),(0,n.jsxs)(e.ol,{children:[(0,n.jsx)(e.li,{children:\"Auth0 generates a New pair of keys.\"}),(0,n.jsx)(e.li,{children:\"Auth0 puts the New Public Key in the jwks.json list, but keeps the Old Public Key there too.\"}),(0,n.jsx)(e.li,{children:\"Auth0 starts signing new tokens with the New Private Key.\"}),(0,n.jsx)(e.li,{children:\"The Go service downloads the updated list (within 5 mins).\"}),(0,n.jsx)(e.li,{children:\"Because the list has both keys, Go can verify both old tokens (valid until they expire) and new tokens.\"})]}),(0,n.jsx)(e.p,{children:\"So, we just changed the entire security foundation without changing a single line of code or restarting a single server.\"}),(0,n.jsxs)(e.h3,{id:\"4-seeing-it-in-action\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#4-seeing-it-in-action\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"4. Seeing it in action\"]}),(0,n.jsx)(e.p,{children:\"I triggered a rotation in Auth0:\"}),(0,n.jsx)(c,{width:600,src:\"/static/images/general/occ_5.png\"}),(0,n.jsx)(e.p,{children:\"I ran the client again without changing code:\"}),(0,n.jsx)(e.pre,{className:\"language-shell\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-shell\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"base\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),` ss@ss:~/client_credential1120$ python3 supa_cli.py\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"Requesting Token from https://dev-724gim41fcgi3z2p.us.auth0.com/oauth/token\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"Token retrieved successfully\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`------------------------------------------------------------\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Access Token:\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"..\"}),`.blabla\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`------------------------------------------------------------\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"Calling API: http://localhost:8080/api/data \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Call successful\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"Server response: \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'data'\"}),(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'Secret A'\"}),\", \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'Secret B'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\", \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'message'\"}),(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'Congras! Authentication success!'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"Look closely, the kid has changed automatically:\"}),(0,n.jsx)(c,{width:600,src:\"/static/images/general/occ_6.png\"}),(0,n.jsx)(e.p,{children:\"And verified in the backend:\"}),(0,n.jsx)(c,{width:300,src:\"/static/images/general/occ_7.png\"}),(0,n.jsxs)(e.h2,{id:\"running-result\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#running-result\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Running Result\"]}),(0,n.jsx)(c,{width:600,src:\"/static/images/general/occ_8.png\"}),(0,n.jsxs)(e.h2,{id:\"appendix-doing-the-math-for-the-curious\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#appendix-doing-the-math-for-the-curious\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Appendix: Doing the Math (For the curious)\"]}),(0,n.jsxs)(e.p,{children:[\"I mentioned that we use \",(0,n.jsx)(e.code,{children:\"n\"}),\" (Modulus) and \",(0,n.jsx)(e.code,{children:\"e\"}),\" (Exponent) to restore the RSA Public Key and verify the signature. If you don't trust the library and want to see the math yourself, here is a Python script I wrote to manually verify the JWT.\"]}),(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-python\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` base64\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` json\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" cryptography\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"hazmat\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"primitives\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"asymmetric \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` rsa\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" cryptography\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"hazmat\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"primitives \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` serialization\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" cryptography\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"hazmat\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"primitives \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` hashes\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" cryptography\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"hazmat\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"primitives\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"asymmetric \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` padding\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" cryptography\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"hazmat\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"backends \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` default_backend\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# ================= Configuration Area =================\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 1. Paste your full Token here\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"TOKEN \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"eyJhbGciO...\"'}),` \n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 2. Paste the corresponding n and e values found in jwks.json\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Note: Must match the key pair corresponding to the kid in the Token Header\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"N_VALUE \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"4CemFJ7TlHiram...\"'}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# This is a very long string\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"E_VALUE \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"AQAB\"'}),\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Usually very short\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# ======================================================\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"base64_to_int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data_str\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token string triple-quoted-string\",children:`\"\"\"\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string triple-quoted-string\",children:`    Helper function: Convert Base64URL string to Integer (Big Integer)\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string triple-quoted-string\",children:`    Principle: Base64 -\u003e Bytes -\u003e Integer\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string triple-quoted-string\",children:'    \"\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 1. Add Base64 padding ('=') to avoid decoding errors\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    padding_len \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data_str\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" padding_len \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        data_str \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"=\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),` padding_len\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 2. Base64URL decode to bytes\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    decoded_bytes \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" base64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"urlsafe_b64decode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data_str\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# 3. Convert bytes to Big Integer (Big Endian)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"from_bytes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"decoded_bytes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" byteorder\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'big'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"manual_verify\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"--- Starting manual public key construction and verification ---\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Step 1: Reconstruct RSA Public Key Object\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# This is a purely mathematical process: Public Key = (n, e)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"try\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        n_int \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" base64_to_int\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"N_VALUE\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        e_int \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" base64_to_int\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"E_VALUE\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string-interpolation\",children:(0,n.jsx)(e.span,{className:\"token string\",children:'f\"[1] Conversion successful:\"'})}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"    n (First 50 digits): '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"n_int\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token format-spec\",children:\"50]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'...\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"    e (Integer): '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"e_int\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Use the cryptography library to assemble n and e into a public key object\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        public_numbers \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" rsa\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"RSAPublicNumbers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"e_int\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" n_int\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        public_key \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" public_numbers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"public_key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"default_backend\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"[2] RSA Public Key object constructed successfully!\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"except\"}),\" Exception \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"as\"}),\" e\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Public key reconstruction failed: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"e\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Step 2: Disassemble Token\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# JWT Format: Header.Payload.Signature\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    parts \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" TOKEN\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'.'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"parts\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Invalid Token format\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The signature is also Base64URL encoded and needs to be decoded into raw bytes\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    header_payload \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" parts\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'.'\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" parts\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# This is the original content that was signed (Message)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    signature_b64 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" parts\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Add padding and decode signature\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    sig_padding \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"signature_b64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" sig_padding \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        signature_b64 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"=\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),` sig_padding\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    signature_bytes \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" base64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"urlsafe_b64decode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"signature_b64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"[3] Token disassembled successfully. Data length to verify: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"header_payload\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:' bytes\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Step 3: Perform Mathematical Signature Verification\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Algorithm: RS256 (RSA Signature + SHA256 Hash)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"try\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        public_key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"verify\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            signature_bytes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"                        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# The real signature (Encrypted Hash)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            header_payload\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'ascii'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"         \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Original content (We calculate the Hash ourselves)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            padding\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"PKCS1v15\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"                     \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# JWT standard uses PKCS1 v1.5 padding\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            hashes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"SHA256\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"                         \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# JWT standard uses SHA256\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"\\\\n\\u2705 Verification Passed! (Signature Valid)\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Conclusion: This Token was indeed signed by the entity holding the private key (Auth0) and has not been tampered with.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"except\"}),\" Exception \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"as\"}),\" e\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"\\\\n\\u274C Verification Failed! (Signature Invalid)\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"Error details: '}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"e\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Possible reasons:\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"1. Incorrect n or e copied (must match kid)\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"2. Incomplete Token copied\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"3. Token content has been modified\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"__main__\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    manual_verify\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"The Result:\"}),(0,n.jsx)(c,{width:600,src:\"/static/images/general/occ_9.png\"})]})}}var b=w;function v(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return A;})();\n;return Component;","toc":[{"value":"Why We Need to Drop the \"Artisanal, Hand-Crafted\" Tokens","url":"#why-we-need-to-drop-the-artisanal-hand-crafted-tokens","depth":2},{"value":"The Flow","url":"#the-flow","depth":2},{"value":"Part 1: Auth0 Configuration (Control Plane)","url":"#part-1-auth0-configuration-control-plane","depth":2},{"value":"1. Create the API (Resource Server)","url":"#1-create-the-api-resource-server","depth":3},{"value":"2. Define Scopes","url":"#2-define-scopes","depth":3},{"value":"3. Create the M2M Application (Client)","url":"#3-create-the-m2m-application-client","depth":3},{"value":"4. Authorize","url":"#4-authorize","depth":3},{"value":"5. Get the Credentials","url":"#5-get-the-credentials","depth":3},{"value":"Part 2: The Downstream Service (Go + Gin)","url":"#part-2-the-downstream-service-go--gin","depth":2},{"value":"Part 3: The Upstream Client (Python)","url":"#part-3-the-upstream-client-python","depth":2},{"value":"Part 4: JWKS \u0026 The Magic of Rotation","url":"#part-4-jwks--the-magic-of-rotation","depth":2},{"value":"1. What is JWKS?","url":"#1-what-is-jwks","depth":3},{"value":"2. Caching (Don't kill the server)","url":"#2-caching-dont-kill-the-server","depth":3},{"value":"3. The Killer Feature: Key Rotation (Zero Downtime)","url":"#3-the-killer-feature-key-rotation-zero-downtime","depth":3},{"value":"4. Seeing it in action","url":"#4-seeing-it-in-action","depth":3},{"value":"Running Result","url":"#running-result","depth":2},{"value":"Appendix: Doing the Math (For the curious)","url":"#appendix-doing-the-math-for-the-curious","depth":2}],"frontMatter":{"readingTime":{"text":"17 min read","minutes":16.825,"time":1009500,"words":3365},"slug":"general/oauth2_jwks","fileName":"general/oauth2_jwks.md","title":"Stop Hand-Crafting Tokens","date":"2025-11-22T00:00:00.000Z","tags":["Architect"],"draft":false,"summary":"Stop using hard-coded tokens like it's 2007: A deep dive into securing microservices with OAuth 2.0 Client Credentials and the magic of JWKS key rotation.","images":[]}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.72,"time":43200,"words":144},"slug":["default"],"fileName":"default.md","name":"Ted","avatar":"/static/images/avatar.jpg","occupation":"CISSP, CKS, AWS Certified Security – Specialty, Microsoft Cybersecurity Architect Expert","email":"nerd@supasaf.com","twitter":"https://twitter.com/supasaf","date":null}],"prev":{"title":"Stop Making Your S3 Buckets Public! A Guide to Presigned URLs","date":"2025-11-15T00:00:00.000Z","tags":["Terraform","Cloud","AWS"],"draft":false,"summary":"Learn how to use S3 Presigned URLs to securely share private files without ever making your bucket public.","slug":"terraform/terraform_sec_6_presigned"},"next":null},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["general","oauth2_jwks"]},"buildId":"E96RjgNfzLGDnuWZMjXP-","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>