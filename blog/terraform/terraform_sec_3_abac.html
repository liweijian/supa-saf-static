<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>ABAC and RBAC: A Journey with Terraform and AWS Tagged Resources</title><meta name="robots" content="follow, index"/><meta name="description" content="Exploring the nuances of Attribute-based Access Control (ABAC) and Role-based Access Control (RBAC) in cloud security using Terraform, and understanding their strategic implementation in managing AWS tagged resources."/><meta property="og:url" content="https://www.supasaf.com/blog/terraform/terraform_sec_3_abac"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Cybersecurity, Cloud and Compiler"/><meta property="og:description" content="Exploring the nuances of Attribute-based Access Control (ABAC) and Role-based Access Control (RBAC) in cloud security using Terraform, and understanding their strategic implementation in managing AWS tagged resources."/><meta property="og:title" content="ABAC and RBAC: A Journey with Terraform and AWS Tagged Resources"/><meta property="og:image" content="https://www.supasaf.com/static/images/twitter-card.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="ABAC and RBAC: A Journey with Terraform and AWS Tagged Resources"/><meta name="twitter:description" content="Exploring the nuances of Attribute-based Access Control (ABAC) and Role-based Access Control (RBAC) in cloud security using Terraform, and understanding their strategic implementation in managing AWS tagged resources."/><meta name="twitter:image" content="https://www.supasaf.com/static/images/twitter-card.png"/><link rel="canonical" href="https://www.supasaf.com/blog/terraform/terraform_sec_3_abac"/><meta property="article:published_time" content="2023-05-16T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.supasaf.com/blog/terraform/terraform_sec_3_abac"
  },
  "headline": "ABAC and RBAC: A Journey with Terraform and AWS Tagged Resources",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://www.supasaf.com/static/images/twitter-card.png"
    }
  ],
  "datePublished": "2023-05-16T00:00:00.000Z",
  "dateModified": "2023-05-16T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Ted"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Supa Safe",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.supasaf.com/static/images/logo2.png"
    }
  },
  "description": "Exploring the nuances of Attribute-based Access Control (ABAC) and Role-based Access Control (RBAC) in cloud security using Terraform, and understanding their strategic implementation in managing AWS tagged resources."
}</script><meta name="next-head-count" content="20"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/52032488e305abd8.css" as="style"/><link rel="stylesheet" href="/_next/static/css/52032488e305abd8.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-7bf052786ac70438.js" defer=""></script><script src="/_next/static/chunks/main-80446c6fe86f961e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c8c0eb7eb758c19d.js" defer=""></script><script src="/_next/static/chunks/410-35c4fb535edd9439.js" defer=""></script><script src="/_next/static/chunks/1-53b2bdc23927c90b.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-0728882d0f489132.js" defer=""></script><script src="/_next/static/q_9Ag_-9xaJ7oq1PyhL3y/_buildManifest.js" defer=""></script><script src="/_next/static/q_9Ag_-9xaJ7oq1PyhL3y/_ssgManifest.js" defer=""></script><script src="/_next/static/q_9Ag_-9xaJ7oq1PyhL3y/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Supa Safe" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g stroke-width="1.5" fill="none"><path stroke="#93a3a9" vector-effect="non-scaling-stroke" d="M255.59 32.64q-1.42-.7-3.54-1.73a1.5 1.49-45.2 0 0-1.32.01q-50.57 24.94-105.46 35.16Q99.16 74.67 52.7 75a.96.95-89.7 0 0-.95.95q-.16 35.05.24 69.05.56 47.23 9.78 93.54 22.44 112.62 103.44 192.11 7.03 6.89 14.68 13.57 32.68 28.51 70.66 50.1a1.23 1.23-45.1 0 0 1.24 0q40.62-23.16 75.25-54.53Q412.88 362.01 438 248.5q10.21-46.13 12.25-95.75.57-13.88.19-77.19a.51.5-89.4 0 0-.49-.51q-52.56-.84-96.7-10.05-28.79-6.01-56.65-15.41-21.08-7.11-41.01-16.95"></path><path stroke="#3b777e" vector-effect="non-scaling-stroke" d="M255.83 59.14q-2.08-.89-3.82-1.68a2.11 2.1 45.2 0 0-1.72-.01q-39.78 17.64-81.04 27.05Q122.6 95.15 74.8 97.54a.53.51 88.9 0 0-.49.53q-.09 23.34-.07 46.68.01 11.6.53 19.99 2.46 39.82 11.48 80.26 11.03 49.46 34.97 92.77 21.15 38.27 51.8 69.46 34.34 34.95 77.32 60.62a1.3 1.3 90 0 0 1.32 0q43.02-25.62 77.21-60.73 64.32-66.08 85.64-156.07 9.17-38.71 12.3-78.32.7-8.83 1-19.97.75-26.89.43-54.51a.73.72-89.2 0 0-.69-.72q-55.89-2.9-109.45-16.98-31.93-8.4-62.27-21.41"></path><path stroke="#a7d3d4" vector-effect="non-scaling-stroke" d="M202.69 315.81q19.99 18.66 48.13 35.43a.83.83 90 0 0 .86 0q21.29-12.65 40.29-28.42 9.61-7.98 14.13-14.06 11.65-15.69 11.65-35.76v-90.98a.52.52 90 0 0-.52-.52l-132.42.06a.5.49 0 0 0-.5.49q.32 45.48.38 90.95.03 26.05 18 42.81"></path><path stroke="#93a3aa" vector-effect="non-scaling-stroke" d="M195.06 187.52q-1.81-.09-4.01.03a.59.58 88.5 0 0-.55.59v71.12q0 16.12.49 19.97 2.71 21.36 19.85 35.93 18.84 16.01 39.98 28.83a.83.83 90 0 0 .86 0q19.76-11.9 38.88-27.93 20.76-17.39 20.83-44.56.11-41.38.11-83.55a.45.45 45 0 0-.45-.45q-55.89-.11-111.98.18-.5 0-4.01-.16"></path><path stroke="#93a3aa" vector-effect="non-scaling-stroke" d="m250.65 258.4-41.2-40.58q-.68-.67-.69.29l-.26 27.64a1.18 1.16-67.2 0 0 .34.85l41.72 41.83a.63.62-44.7 0 0 .89 0l41.45-41.58a1.28 1.17 69.8 0 0 .35-.85l.19-27.82q.01-1.24-.87-.38l-41.21 40.6a.51.5-44.6 0 1-.71 0"></path></g><path fill="#fffefe" d="M0 0h512v512H0V0Zm255.59 32.64q-1.42-.7-3.54-1.73a1.5 1.49-45.2 0 0-1.32.01q-50.57 24.94-105.46 35.16Q99.16 74.67 52.7 75a.96.95-89.7 0 0-.95.95q-.16 35.05.24 69.05.56 47.23 9.78 93.54 22.44 112.62 103.44 192.11 7.03 6.89 14.68 13.57 32.68 28.51 70.66 50.1a1.23 1.23-45.1 0 0 1.24 0q40.62-23.16 75.25-54.53Q412.88 362.01 438 248.5q10.21-46.13 12.25-95.75.57-13.88.19-77.19a.51.5-89.4 0 0-.49-.51q-52.56-.84-96.7-10.05-28.79-6.01-56.65-15.41-21.08-7.11-41.01-16.95Z"></path><path fill="#274754" d="M255.59 32.64q19.93 9.84 41.01 16.95 27.86 9.4 56.65 15.41 44.14 9.21 96.7 10.05a.51.5-89.4 0 1 .49.51q.38 63.31-.19 77.19-2.04 49.62-12.25 95.75-25.12 113.51-110.96 191.29-34.63 31.37-75.25 54.53a1.23 1.23-44.4 0 1-1.24 0q-37.98-21.59-70.66-50.1-7.65-6.68-14.68-13.57-81-79.49-103.44-192.11-9.22-46.31-9.78-93.54-.4-34-.24-69.05a.96.95-89.7 0 1 .95-.95q46.46-.33 92.57-8.92 54.89-10.22 105.46-35.16a1.5 1.49-45.2 0 1 1.32-.01q2.12 1.03 3.54 1.73Zm.24 26.5q-2.08-.89-3.82-1.68a2.11 2.1 45.2 0 0-1.72-.01q-39.78 17.64-81.04 27.05Q122.6 95.15 74.8 97.54a.53.51 88.9 0 0-.49.53q-.09 23.34-.07 46.68.01 11.6.53 19.99 2.46 39.82 11.48 80.26 11.03 49.46 34.97 92.77 21.15 38.27 51.8 69.46 34.34 34.95 77.32 60.62a1.3 1.3 90 0 0 1.32 0q43.02-25.62 77.21-60.73 64.32-66.08 85.64-156.07 9.17-38.71 12.3-78.32.7-8.83 1-19.97.75-26.89.43-54.51a.73.72-89.2 0 0-.69-.72q-55.89-2.9-109.45-16.98-31.93-8.4-62.27-21.41Z"></path><path fill="#4ea7a8" d="M255.83 59.14q30.34 13.01 62.27 21.41 53.56 14.08 109.45 16.98a.73.72-89.2 0 1 .69.72q.32 27.62-.43 54.51-.3 11.14-1 19.97-3.13 39.61-12.3 78.32-21.32 89.99-85.64 156.07-34.19 35.11-77.21 60.73a1.3 1.3-90 0 1-1.32 0q-42.98-25.67-77.32-60.62-30.65-31.19-51.8-69.46Q97.28 294.46 86.25 245q-9.02-40.44-11.48-80.26-.52-8.39-.53-19.99-.02-23.34.07-46.68a.53.51 88.9 0 1 .49-.53q47.8-2.39 94.45-13.04 41.26-9.41 81.04-27.05a2.11 2.1 45.2 0 1 1.72.01q1.74.79 3.82 1.68Zm-53.14 256.67q19.99 18.66 48.13 35.43a.83.83 90 0 0 .86 0q21.29-12.65 40.29-28.42 9.61-7.98 14.13-14.06 11.65-15.69 11.65-35.76v-90.98a.52.52 90 0 0-.52-.52l-132.42.06a.5.49 0 0 0-.5.49q.32 45.48.38 90.95.03 26.05 18 42.81Z"></path><path fill="#fff" d="M202.69 315.81q-17.97-16.76-18-42.81-.06-45.47-.38-90.95a.5.49 0 0 1 .5-.49l132.42-.06a.52.52-90 0 1 .52.52V273q0 20.07-11.65 35.76-4.52 6.08-14.13 14.06-19 15.77-40.29 28.42a.83.83-90 0 1-.86 0q-28.14-16.77-48.13-35.43Zm-7.63-128.29q-1.81-.09-4.01.03a.59.58 88.5 0 0-.55.59v71.12q0 16.12.49 19.97 2.71 21.36 19.85 35.93 18.84 16.01 39.98 28.83a.83.83 90 0 0 .86 0q19.76-11.9 38.88-27.93 20.76-17.39 20.83-44.56.11-41.38.11-83.55a.45.45 45 0 0-.45-.45q-55.89-.11-111.98.18-.5 0-4.01-.16Z"></path><path fill="#274654" d="M199.07 187.68q56.09-.29 111.98-.18a.45.45 45 0 1 .45.45q0 42.17-.11 83.55-.07 27.17-20.83 44.56-19.12 16.03-38.88 27.93a.83.83-90 0 1-.86 0q-21.14-12.82-39.98-28.83-17.14-14.57-19.85-35.93-.49-3.85-.49-19.97v-71.12a.59.58 88.5 0 1 .55-.59q2.2-.12 4.01-.03 3.51.16 4.01.16Zm51.58 70.72-41.2-40.58q-.68-.67-.69.29l-.26 27.64a1.18 1.16-67.2 0 0 .34.85l41.72 41.83a.63.62-44.7 0 0 .89 0l41.45-41.58a1.28 1.17 69.8 0 0 .35-.85l.19-27.82q.01-1.24-.87-.38l-41.21 40.6a.51.5-44.6 0 1-.71 0Z"></path><path fill="#fff" d="m251.36 258.4 41.21-40.6q.88-.86.87.38l-.19 27.82a1.28 1.17 69.8 0 1-.35.85l-41.45 41.58a.63.62-44.7 0 1-.89 0l-41.72-41.83a1.18 1.16-67.2 0 1-.34-.85l.26-27.64q.01-.96.69-.29l41.2 40.58a.51.5-44.6 0 0 .71 0Z"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Supa Safe</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2023-05-16T00:00:00.000Z">Tuesday, May 16, 2023</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">ABAC and RBAC: A Journey with Terraform and AWS Tagged Resources</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="/static/images/avatar.jpg" width="38px" height="38px" alt="avatar" class="h-10 w-10 rounded-full"/><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Ted</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/supasaf" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">@supasaf</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><p>Alright, let&#x27;s talk about granting permissions in your cloud kingdom. If you just give everyone the master key, you&#x27;re going to have a bad time. So, we need a system. For decades, we&#x27;ve had two main schools of thought on this, kind of like two competing martial arts dojos: the Way of the Role (RBAC) and the Way of the Attribute (ABAC).</p><p>So what&#x27;s the difference? Let&#x27;s go back to our trusty cloud castle analogy.</p><ul><li><p><strong>RBAC (Role-Based Access Control)</strong>: This is the classic, straightforward approach. You get permissions based on your job title. We create a &quot;Guard&quot; role, and all guards get a key that opens the armory. We create a &quot;Chef&quot; role, and all chefs get a key to the pantry. It&#x27;s simple, predictable, and easy to explain.</p></li><li><p><strong>ABAC (Attribute-Based Access Control)</strong>: This is the fancy, modern, some might say magical approach. Permissions are based on attributes (or &quot;tags&quot; in AWS). It’s like a smart-lock system. The rule isn&#x27;t &quot;Only Chefs can open the pantry.&quot; It&#x27;s &quot;The pantry door will only open for a person whose ID card has the <code>Department=Kitchen</code> attribute, and only if the time is between 6 AM and 8 PM, and only if they are wearing the official Chef&#x27;s Hat.&quot; It&#x27;s way more flexible and powerful.</p></li></ul><p>Let&#x27;s see how these two styles play out in the real world with AWS and Terraform.</p><h2 id="the-rbac-way-simple-and-structured"><a href="#the-rbac-way-simple-and-structured" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>The RBAC Way: Simple and Structured</h2><p>RBAC is the bread and butter of access control. You define a role, attach permissions to it, and then assign users to that role. It&#x27;s perfect for stable organizations where everyone&#x27;s job is clearly defined.</p><p>With Terraform, creating a role is no big deal.</p><div class="relative"><pre><code class="language-hcl code-highlight"><span class="code-line"><span class="token keyword">resource <span class="token type variable">&quot;aws_iam_role&quot;</span></span> <span class="token string">&quot;test_role&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">name</span> <span class="token punctuation">=</span> <span class="token string">&quot;test_role&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token property">assume_role_policy</span> <span class="token punctuation">=</span> data.aws_iam_policy_document.assume_role.json
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">resource <span class="token type variable">&quot;aws_iam_role_policy_attachment&quot;</span></span> <span class="token string">&quot;test_role_policy&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">role</span>       <span class="token punctuation">=</span> aws_iam_role.test_role.name
</span><span class="code-line">  <span class="token property">policy_arn</span> <span class="token punctuation">=</span> aws_iam_policy.test_policy.arn
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>Anyone assigned to <code>test_role</code> gets the powers defined in <code>test_policy</code>. Easy peasy. The downside? If you have lots of slightly different teams, you can end up with hundreds of roles (&quot;Test-Developers&quot;, &quot;Prod-Developers&quot;, &quot;Super-Prod-Developers-Who-Can-Also-Order-Pizza&quot;). This is called &quot;role explosion,&quot; and it&#x27;s not fun to manage.</p><h2 id="the-abac-way-flexible-and-scalable-with-tags"><a href="#the-abac-way-flexible-and-scalable-with-tags" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>The ABAC Way: Flexible and Scalable with Tags</h2><p>This is where things get interesting. ABAC uses tags (which are just simple labels) to make smarter decisions. Instead of creating a new role for every project, you just create a new tag!</p><p>First, let&#x27;s use Terraform to create an S3 bucket and slap a tag on it. We&#x27;re labeling this bucket as part of the &quot;Test&quot; environment.</p><div class="relative"><pre><code class="language-hcl code-highlight"><span class="code-line"><span class="token keyword">resource <span class="token type variable">&quot;aws_s3_bucket&quot;</span></span> <span class="token string">&quot;bucket&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">bucket</span> <span class="token punctuation">=</span> <span class="token string">&quot;supasaf-test-bucket&quot;</span>
</span><span class="code-line">  <span class="token property">acl</span>    <span class="token punctuation">=</span> <span class="token string">&quot;private&quot;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token property">tags</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">Environment</span> <span class="token punctuation">=</span> <span class="token string">&quot;Test&quot;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>Now for the magic. We&#x27;ll create a policy that doesn&#x27;t care who you are or what your job title is. It only cares about attributes. This policy says, &quot;You can put an object in this bucket, but <strong>only if</strong> you also tag that new object with <code>Environment=Test</code>.&quot;</p><div class="relative"><pre><code class="language-hcl code-highlight"><span class="code-line"><span class="token keyword">data <span class="token type variable">&quot;aws_iam_policy_document&quot;</span></span> <span class="token string">&quot;s3_limited&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">statement</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">actions</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">      <span class="token string">&quot;s3:ListBucket&quot;</span>,
</span><span class="code-line">    <span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token property">resources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">      aws_s3_bucket.bucket.arn,
</span><span class="code-line">    <span class="token punctuation">]</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">statement</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">actions</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">      <span class="token string">&quot;s3:GetObject&quot;</span>,
</span><span class="code-line">      <span class="token string">&quot;s3:PutObject&quot;</span>,
</span><span class="code-line">      <span class="token string">&quot;s3:PutObjectTagging&quot;</span>
</span><span class="code-line">    <span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token property">resources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">      <span class="token string">&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span>aws_s3_bucket<span class="token punctuation">.</span>bucket<span class="token punctuation">.</span>arn<span class="token punctuation">}</span></span>/*&quot;</span>,
</span><span class="code-line">    <span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">condition</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property">test</span>     <span class="token punctuation">=</span> <span class="token string">&quot;StringEquals&quot;</span>
</span><span class="code-line">      <span class="token property">variable</span> <span class="token punctuation">=</span> <span class="token string">&quot;s3:RequestObjectTag/Environment&quot;</span>
</span><span class="code-line">      <span class="token property">values</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">        <span class="token string">&quot;Test&quot;</span>,
</span><span class="code-line">      <span class="token punctuation">]</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>Let&#x27;s create a user and give them this shiny new policy.</p><div class="relative"><pre><code class="language-hcl code-highlight"><span class="code-line"><span class="token keyword">resource <span class="token type variable">&quot;aws_iam_policy&quot;</span></span> <span class="token string">&quot;s3_limited_policy&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">name</span>        <span class="token punctuation">=</span> <span class="token string">&quot;s3_limited&quot;</span>
</span><span class="code-line">  <span class="token property">description</span> <span class="token punctuation">=</span> <span class="token string">&quot;S3 limited policy&quot;</span>
</span><span class="code-line">  <span class="token property">policy</span>      <span class="token punctuation">=</span> data.aws_iam_policy_document.s3_limited.json
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">resource <span class="token type variable">&quot;aws_iam_user&quot;</span></span> <span class="token string">&quot;user&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">name</span> <span class="token punctuation">=</span> <span class="token string">&quot;s3_limited_user&quot;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">resource <span class="token type variable">&quot;aws_iam_user_policy_attachment&quot;</span></span> <span class="token string">&quot;user_s3_limited&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">user</span>       <span class="token punctuation">=</span> aws_iam_user.user.name
</span><span class="code-line">  <span class="token property">policy_arn</span> <span class="token punctuation">=</span> aws_iam_policy.s3_limited_policy.arn
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>Now, let&#x27;s try to use our new user&#x27;s credentials to upload a file. Notice we have to provide the <code>--tagging &#x27;Environment=Test&#x27;</code> part. We&#x27;re presenting the correct &quot;attribute&quot; to the magical lock.</p><div class="relative"><pre><code class="code-highlight language-shell"><span class="code-line">❯ aws s3api put-object --bucket supasaf-test-bucket --key test.txt --body test.txt --tagging <span class="token string">&#x27;Environment=Test&#x27;</span> --profile s3_limited_user
</span><span class="code-line">
</span><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token string">&quot;ETag&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;<span class="token entity" title="\&quot;">\&quot;</span>bc98d84673286ce1447eca1766f28504<span class="token entity" title="\&quot;">\&quot;</span>&quot;</span>,
</span><span class="code-line">    <span class="token string">&quot;ServerSideEncryption&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;AES256&quot;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>Success! The smart-lock saw our tag and let us in. If we tried this without the tag, AWS would have slammed the door in our face. We can see our correctly tagged file sitting happily in the bucket.</p><img width="600" src="/static/images/terraform/terra_s3_tags.png"/><h2 id="building-a-policy-machine"><a href="#building-a-policy-machine" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Building a Policy Machine</h2><p>The real power of ABAC with Terraform is that you can build dynamic policies. Look at this example where we use a variable to define the environment.</p><div class="relative"><pre><code class="language-hcl code-highlight"><span class="code-line"><span class="token keyword">variable<span class="token type variable"> &quot;environment&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">description</span> <span class="token punctuation">=</span> <span class="token string">&quot;The environment for which to grant access&quot;</span>
</span><span class="code-line">  <span class="token property">type</span>        <span class="token punctuation">=</span> string
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">data <span class="token type variable">&quot;aws_iam_policy_document&quot;</span></span> <span class="token string">&quot;s3_limited&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">statement</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">effect</span> <span class="token punctuation">=</span> <span class="token string">&quot;Allow&quot;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token property">actions</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">      <span class="token string">&quot;s3:*&quot;</span>,
</span><span class="code-line">    <span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token property">resources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">      <span class="token string">&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span>aws_s3_bucket<span class="token punctuation">.</span>bucket<span class="token punctuation">.</span>arn<span class="token punctuation">}</span></span>/*&quot;</span>,
</span><span class="code-line">    <span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">condition</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property">test</span>     <span class="token punctuation">=</span> <span class="token string">&quot;StringEquals&quot;</span>
</span><span class="code-line">      <span class="token property">variable</span> <span class="token punctuation">=</span> <span class="token string">&quot;s3:ExistingObjectTag/Environment&quot;</span>
</span><span class="code-line">      <span class="token property">values</span>   <span class="token punctuation">=</span> <span class="token punctuation">[</span>var.environment<span class="token punctuation">]</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>With this, you can apply the same Terraform code for your &quot;Test&quot;, &quot;Staging&quot;, and &quot;Prod&quot; environments just by changing one variable. You&#x27;ve built a policy-making machine instead of hand-crafting policies one by one.</p><h2 id="so-which-kung-fu-style-is-best"><a href="#so-which-kung-fu-style-is-best" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>So, Which Kung Fu Style is Best?</h2><p>Here’s the secret: you don’t have to choose! The best dojos teach a mix of styles.</p><ul><li><p>Use <strong>RBAC</strong> for broad, company-wide permissions that don&#x27;t change much. For example, a &quot;Billing-Admins&quot; role or a &quot;ReadOnly-Auditors&quot; role.</p></li><li><p>Use <strong>ABAC</strong> for your dynamic, project-based work. It&#x27;s perfect for development teams working across multiple projects and environments because you can grant access to resources based on a project:X or team:Y tag without creating a million roles.</p></li></ul><p>The key is to understand that security isn&#x27;t a one-size-fits-all problem. By having both RBAC and ABAC in your toolkit, you have the flexibility to build a security model that is both powerful and manageable. You get the best of both worlds—the simplicity of roles and the fine-grained, scalable power of attributes. Now go forth and secure your castle!</p></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/terraform">Terraform</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/cloud">Cloud</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/aws">AWS</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/terraform/terraform_sec_2_iam1">An IAM Split-Privilege Model with Terraform for Robust Cybersecurity</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/terraform/terraform_sec_4_bastion">Bastion Hosts: Safeguarding Your Cloud Resources</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Supa Safe</div><div> • </div><div>© 2025</div><div> • </div><a href="/">Cybersecurity, Cloud and Compiler</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var d=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var i=a=\u003el(a,\"__esModule\",{value:!0});var N=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=\u003e{i(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},g=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let n of h(s))!u.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026l(a,n,{get:()=\u003es[n],enumerable:!(c=p(s,n))||c.enumerable});return a},y=a=\u003eg(i(l(a!=null?d(m(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=N((T,o)=\u003e{o.exports=_jsx_runtime});var v={};k(v,{default:()=\u003ef,frontmatter:()=\u003eb});var e=y(r()),b={title:\"ABAC and RBAC: A Journey with Terraform and AWS Tagged Resources\",date:\"2023-05-16\",tags:[\"Terraform\",\"Cloud\",\"AWS\"],draft:!1,summary:\"Exploring the nuances of Attribute-based Access Control (ABAC) and Role-based Access Control (RBAC) in cloud security using Terraform, and understanding their strategic implementation in managing AWS tagged resources.\"};function w(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({p:\"p\",ul:\"ul\",li:\"li\",strong:\"strong\",code:\"code\",h2:\"h2\",a:\"a\",span:\"span\",pre:\"pre\"},a.components),{Image:t}=n;return t||_(\"Image\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.p,{children:\"Alright, let's talk about granting permissions in your cloud kingdom. If you just give everyone the master key, you're going to have a bad time. So, we need a system. For decades, we've had two main schools of thought on this, kind of like two competing martial arts dojos: the Way of the Role (RBAC) and the Way of the Attribute (ABAC).\"}),(0,e.jsx)(n.p,{children:\"So what's the difference? Let's go back to our trusty cloud castle analogy.\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"RBAC (Role-Based Access Control)\"}),`: This is the classic, straightforward approach. You get permissions based on your job title. We create a \"Guard\" role, and all guards get a key that opens the armory. We create a \"Chef\" role, and all chefs get a key to the pantry. It's simple, predictable, and easy to explain.`]})}),(0,e.jsx)(n.li,{children:(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"ABAC (Attribute-Based Access Control)\"}),`: This is the fancy, modern, some might say magical approach. Permissions are based on attributes (or \"tags\" in AWS). It\\u2019s like a smart-lock system. The rule isn't \"Only Chefs can open the pantry.\" It's \"The pantry door will only open for a person whose ID card has the `,(0,e.jsx)(n.code,{children:\"Department=Kitchen\"}),` attribute, and only if the time is between 6 AM and 8 PM, and only if they are wearing the official Chef's Hat.\" It's way more flexible and powerful.`]})})]}),(0,e.jsx)(n.p,{children:\"Let's see how these two styles play out in the real world with AWS and Terraform.\"}),(0,e.jsxs)(n.h2,{id:\"the-rbac-way-simple-and-structured\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#the-rbac-way-simple-and-structured\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"The RBAC Way: Simple and Structured\"]}),(0,e.jsx)(n.p,{children:\"RBAC is the bread and butter of access control. You define a role, attach permissions to it, and then assign users to that role. It's perfect for stable organizations where everyone's job is clearly defined.\"}),(0,e.jsx)(n.p,{children:\"With Terraform, creating a role is no big deal.\"}),(0,e.jsx)(n.pre,{className:\"language-hcl\",children:(0,e.jsxs)(n.code,{className:\"language-hcl code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_iam_role\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"test_role\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"name\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"test_role\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"assume_role_policy\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` data.aws_iam_policy_document.assume_role.json\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_iam_role_policy_attachment\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"test_role_policy\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"role\"}),\"\\xA0 \\xA0 \\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_iam_role.test_role.name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"policy_arn\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_iam_policy.test_policy.arn\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Anyone assigned to \",(0,e.jsx)(n.code,{children:\"test_role\"}),\" gets the powers defined in \",(0,e.jsx)(n.code,{children:\"test_policy\"}),`. Easy peasy. The downside? If you have lots of slightly different teams, you can end up with hundreds of roles (\"Test-Developers\", \"Prod-Developers\", \"Super-Prod-Developers-Who-Can-Also-Order-Pizza\"). This is called \"role explosion,\" and it's not fun to manage.`]}),(0,e.jsxs)(n.h2,{id:\"the-abac-way-flexible-and-scalable-with-tags\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#the-abac-way-flexible-and-scalable-with-tags\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"The ABAC Way: Flexible and Scalable with Tags\"]}),(0,e.jsx)(n.p,{children:\"This is where things get interesting. ABAC uses tags (which are just simple labels) to make smarter decisions. Instead of creating a new role for every project, you just create a new tag!\"}),(0,e.jsx)(n.p,{children:`First, let's use Terraform to create an S3 bucket and slap a tag on it. We're labeling this bucket as part of the \"Test\" environment.`}),(0,e.jsx)(n.pre,{className:\"language-hcl\",children:(0,e.jsxs)(n.code,{className:\"language-hcl code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_s3_bucket\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"bucket\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"bucket\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"supasaf-test-bucket\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"acl\"}),\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"private\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"tags\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"Environment\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Test\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[`Now for the magic. We'll create a policy that doesn't care who you are or what your job title is. It only cares about attributes. This policy says, \"You can put an object in this bucket, but `,(0,e.jsx)(n.strong,{children:\"only if\"}),\" you also tag that new object with \",(0,e.jsx)(n.code,{children:\"Environment=Test\"}),'.\"']}),(0,e.jsx)(n.pre,{className:\"language-hcl\",children:(0,e.jsxs)(n.code,{className:\"language-hcl code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"data \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_iam_policy_document\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3_limited\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"statement\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"actions\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3:ListBucket\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"resources\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\xA0 \\xA0 \\xA0 aws_s3_bucket.bucket.arn,\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"statement\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"actions\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3:GetObject\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3:PutObject\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3:PutObjectTagging\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"resources\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsxs)(n.span,{className:\"token string\",children:['\"',(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"$\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"aws_s3_bucket\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"bucket\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"arn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),'/*\"']}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"condition\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"test\"}),\"\\xA0 \\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"StringEquals\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"variable\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3:RequestObjectTag/Environment\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"values\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Test\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"Let's create a user and give them this shiny new policy.\"}),(0,e.jsx)(n.pre,{className:\"language-hcl\",children:(0,e.jsxs)(n.code,{className:\"language-hcl code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_iam_policy\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3_limited_policy\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"name\"}),\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3_limited\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"description\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"S3 limited policy\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"policy\"}),\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` data.aws_iam_policy_document.s3_limited.json\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_iam_user\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"user\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"name\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3_limited_user\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"resource \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_iam_user_policy_attachment\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"user_s3_limited\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"user\"}),\"\\xA0 \\xA0 \\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_iam_user.user.name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"policy_arn\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` aws_iam_policy.s3_limited_policy.arn\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Now, let's try to use our new user's credentials to upload a file. Notice we have to provide the \",(0,e.jsx)(n.code,{children:\"--tagging 'Environment=Test'\"}),` part. We're presenting the correct \"attribute\" to the magical lock.`]}),(0,e.jsx)(n.pre,{className:\"language-shell\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-shell\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\u276F aws s3api put-object --bucket supasaf-test-bucket --key test.txt --body test.txt --tagging \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'Environment=Test'\"}),` --profile s3_limited_user\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"ETag\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsxs)(n.span,{className:\"token string\",children:['\"',(0,e.jsx)(n.span,{className:\"token entity\",title:'\\\\\"',children:'\\\\\"'}),\"bc98d84673286ce1447eca1766f28504\",(0,e.jsx)(n.span,{className:\"token entity\",title:'\\\\\"',children:'\\\\\"'}),'\"']}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"ServerSideEncryption\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"AES256\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"Success! The smart-lock saw our tag and let us in. If we tried this without the tag, AWS would have slammed the door in our face. We can see our correctly tagged file sitting happily in the bucket.\"}),(0,e.jsx)(t,{width:600,src:\"/static/images/terraform/terra_s3_tags.png\"}),(0,e.jsxs)(n.h2,{id:\"building-a-policy-machine\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#building-a-policy-machine\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Building a Policy Machine\"]}),(0,e.jsx)(n.p,{children:\"The real power of ABAC with Terraform is that you can build dynamic policies. Look at this example where we use a variable to define the environment.\"}),(0,e.jsx)(n.pre,{className:\"language-hcl\",children:(0,e.jsxs)(n.code,{className:\"language-hcl code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"variable\",(0,e.jsx)(n.span,{className:\"token type variable\",children:' \"environment\" '})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"description\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"The environment for which to grant access\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"type\"}),\"\\xA0 \\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),` string\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token keyword\",children:[\"data \",(0,e.jsx)(n.span,{className:\"token type variable\",children:'\"aws_iam_policy_document\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3_limited\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"statement\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"effect\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Allow\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"actions\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3:*\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"resources\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsxs)(n.span,{className:\"token string\",children:['\"',(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"$\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"aws_s3_bucket\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"bucket\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"arn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),'/*\"']}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"condition\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"test\"}),\"\\xA0 \\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"StringEquals\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"variable\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"s3:ExistingObjectTag/Environment\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token property\",children:\"values\"}),\"\\xA0 \\xA0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"var.environment\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\\xA0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:`With this, you can apply the same Terraform code for your \"Test\", \"Staging\", and \"Prod\" environments just by changing one variable. You've built a policy-making machine instead of hand-crafting policies one by one.`}),(0,e.jsxs)(n.h2,{id:\"so-which-kung-fu-style-is-best\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#so-which-kung-fu-style-is-best\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"So, Which Kung Fu Style is Best?\"]}),(0,e.jsx)(n.p,{children:\"Here\\u2019s the secret: you don\\u2019t have to choose! The best dojos teach a mix of styles.\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:(0,e.jsxs)(n.p,{children:[\"Use \",(0,e.jsx)(n.strong,{children:\"RBAC\"}),` for broad, company-wide permissions that don't change much. For example, a \"Billing-Admins\" role or a \"ReadOnly-Auditors\" role.`]})}),(0,e.jsx)(n.li,{children:(0,e.jsxs)(n.p,{children:[\"Use \",(0,e.jsx)(n.strong,{children:\"ABAC\"}),\" for your dynamic, project-based work. It's perfect for development teams working across multiple projects and environments because you can grant access to resources based on a project:X or team:Y tag without creating a million roles.\"]})})]}),(0,e.jsx)(n.p,{children:\"The key is to understand that security isn't a one-size-fits-all problem. By having both RBAC and ABAC in your toolkit, you have the flexibility to build a security model that is both powerful and manageable. You get the best of both worlds\\u2014the simplicity of roles and the fine-grained, scalable power of attributes. Now go forth and secure your castle!\"})]})}}var f=w;function _(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return v;})();\n;return Component;","toc":[{"value":"The RBAC Way: Simple and Structured","url":"#the-rbac-way-simple-and-structured","depth":2},{"value":"The ABAC Way: Flexible and Scalable with Tags","url":"#the-abac-way-flexible-and-scalable-with-tags","depth":2},{"value":"Building a Policy Machine","url":"#building-a-policy-machine","depth":2},{"value":"So, Which Kung Fu Style is Best?","url":"#so-which-kung-fu-style-is-best","depth":2}],"frontMatter":{"readingTime":{"text":"7 min read","minutes":6.54,"time":392400,"words":1308},"slug":"terraform/terraform_sec_3_abac","fileName":"terraform/terraform_sec_3_abac.md","title":"ABAC and RBAC: A Journey with Terraform and AWS Tagged Resources","date":"2023-05-16T00:00:00.000Z","tags":["Terraform","Cloud","AWS"],"draft":false,"summary":"Exploring the nuances of Attribute-based Access Control (ABAC) and Role-based Access Control (RBAC) in cloud security using Terraform, and understanding their strategic implementation in managing AWS tagged resources."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.72,"time":43200,"words":144},"slug":["default"],"fileName":"default.md","name":"Ted","avatar":"/static/images/avatar.jpg","occupation":"CISSP, CKS, AWS Certified Security – Specialty, Microsoft Cybersecurity Architect Expert","email":"nerd@supasaf.com","twitter":"https://twitter.com/supasaf","date":null}],"prev":{"title":"An IAM Split-Privilege Model with Terraform for Robust Cybersecurity","date":"2023-05-14T00:00:00.000Z","tags":["Terraform","Cloud","AWS"],"draft":false,"summary":"A practical (and funny) guide to implementing a split-privilege model in AWS. We'll separate the power to create permissions from the power to assign them, making your cloud a whole lot safer.","slug":"terraform/terraform_sec_2_iam1"},"next":{"title":"Bastion Hosts: Safeguarding Your Cloud Resources","date":"2023-06-26T00:00:00.000Z","tags":["Terraform","Cloud","AWS"],"draft":false,"summary":"Discover the significance of bastion hosts in cloud security and learn how to set up a secure gateway using Terraform in AWS, ensuring protection for private resources while reducing the attack surface area.","slug":"terraform/terraform_sec_4_bastion"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["terraform","terraform_sec_3_abac"]},"buildId":"q_9Ag_-9xaJ7oq1PyhL3y","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>